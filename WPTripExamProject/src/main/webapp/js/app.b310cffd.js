(function(){var t={6700:function(t,e,o){var a={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":238,"./ru.js":238,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function s(t){var e=i(t);return o(e)}function i(t){if(!o.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}s.keys=function(){return Object.keys(a)},s.resolve=i,t.exports=s,s.id=6700},1063:function(t,e,o){"use strict";var a=o(144),s=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("Header"),o("router-view"),o("Footer")],1)},i=[],n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("nav",{staticClass:"navbar navbar-dark navbar-expand-lg fixed-top bg-white portfolio-navbar gradient"},[o("div",{staticClass:"container"},[o("a",{staticClass:"navbar-brand logo",attrs:{href:"#"}},[t._v("Map")]),t._m(0),o("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarNav"}},[o("ul",{staticClass:"navbar-nav ms-auto"},[o("li",{staticClass:"nav-item"},[o("router-link",{staticClass:"nav-link active",attrs:{to:"dashboard"}},[t._v("Home")])],1),t._m(1)])])])])},r=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("button",{staticClass:"navbar-toggler",attrs:{"data-bs-toggle":"collapse","data-bs-target":"#navbarNav"}},[o("span",{staticClass:"visually-hidden"},[t._v("Toggle navigation")]),o("span",{staticClass:"navbar-toggler-icon"})])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("li",{staticClass:"nav-item"},[o("a",{staticClass:"nav-link active",attrs:{href:"#"}},[t._v("Logout")])])}],l={name:"Header-component",props:{}},c=l,p=o(1001),d=(0,p.Z)(c,n,r,!1,null,"4cddce8f",null),u=d.exports,m=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},g=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("footer",{staticClass:"page-footer"},[o("div",{staticClass:"container"},[o("p",[t._v("FOOTER")])])])}],h={name:"Footer-component",props:{}},v=h,f=(0,p.Z)(v,m,g,!1,null,null,null),y=f.exports,_={name:"Dashboard-component",components:{Header:u,Footer:y}},b=_,O=(0,p.Z)(b,s,i,!1,null,null,null),C=O.exports,S=o(8345),j=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("div",{staticClass:"login-page"},[o("transition",{attrs:{name:"fade"}},[t.registerActive?t._e():o("div",{staticClass:"wallpaper-login"})]),o("div",{staticClass:"wallpaper-register"}),o("div",{staticClass:"container"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-lg-4 col-md-6 col-sm-8 mx-auto"},[t.registerActive?o("div",{staticClass:"card register",class:{error:t.emptyFields}},[o("h1",[t._v("Sign Up")]),o("div",{staticClass:"illustration"},[o("Icon",{attrs:{icon:"carbon:locked"}})],1),o("form",{staticClass:"form-group",on:{submit:function(t){t.preventDefault()}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{type:"email",placeholder:"Email",required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.usernameRegistration,expression:"usernameRegistration"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Username",required:""},domProps:{value:t.usernameRegistration},on:{input:function(e){e.target.composing||(t.usernameRegistration=e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordRegistration,expression:"passwordRegistration"}],staticClass:"form-control",attrs:{type:"password",placeholder:"Password",required:""},domProps:{value:t.passwordRegistration},on:{input:function(e){e.target.composing||(t.passwordRegistration=e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],staticClass:"form-control",attrs:{type:"password",placeholder:"Confirm Password",required:""},domProps:{value:t.confirmPassword},on:{input:function(e){e.target.composing||(t.confirmPassword=e.target.value)}}}),o("button",{staticClass:"btn gradient",on:{click:function(e){return t.doRegister()}}},[t._v(" Register ")]),o("p",[t._v(" Already have an account? "),o("a",{attrs:{href:"#"},on:{click:function(e){t.registerActive=!t.registerActive,t.emptyFields=!1}}},[t._v("Sign in here")])])])]):o("div",{staticClass:"card login",class:{error:t.emptyFields}},[o("h1",[t._v("Sign In")]),o("div",{staticClass:"illustration"},[o("Icon",{attrs:{icon:"carbon:locked"}})],1),o("form",{staticClass:"form-group",on:{submit:function(t){t.preventDefault()}}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.usernameLogin,expression:"usernameLogin"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Username",required:""},domProps:{value:t.usernameLogin},on:{input:function(e){e.target.composing||(t.usernameLogin=e.target.value)}}}),o("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordLogin,expression:"passwordLogin"}],staticClass:"form-control",attrs:{type:"password",placeholder:"Password",required:""},domProps:{value:t.passwordLogin},on:{input:function(e){e.target.composing||(t.passwordLogin=e.target.value)}}}),o("button",{staticClass:"btn gradient",on:{click:function(e){return t.doLogin()}}},[t._v("Log In")]),o("p",[t._v(" Don't have an account? "),o("a",{attrs:{href:"#"},on:{click:function(e){t.registerActive=!t.registerActive,t.emptyFields=!1}}},[t._v("Sign up here")])])])])])])])],1)])},w=[],T=o(9669),N=o.n(T);const k=localStorage.getItem("token"),P="/WPTripExamProject/api/user";var L={async createUser(t){return N().post(P+"/create",JSON.stringify(t),{headers:{"Content-type":"application/json"}})},async authenticateUser(t){return N().post(P+"/authenticate",JSON.stringify(t),{headers:{"Content-type":"application/json"}})},async updateUser(t){return N().put(P+"/update",JSON.stringify(t),{headers:{"Content-type":"application/json","x-access-token":k}})}},E=o(2856),I={name:"LoginPage",components:{Icon:E.JO},data(){return{registerActive:!1,usernameLogin:null,passwordLogin:null,email:null,usernameRegistration:null,passwordRegistration:null,confirmPassword:null,emptyFields:!1,authenticationResponse:null}},methods:{async doLogin(){if(""===this.usernameLogin||""===this.passwordLogin||null==this.usernameLogin||null==this.passwordLogin)this.emptyFields=!0;else{let t={username:this.usernameLogin,password:this.passwordLogin};await L.authenticateUser(t).then((t=>{this.authenticationResponse=t})).catch((function(t){console.log(t)}));let e=this.authenticationResponse.data["x-access-token"];localStorage.setItem("token",e),localStorage.setItem("id",this.authenticationResponse.data.ID),localStorage.setItem("username",this.authenticationResponse.data.USERNAME),localStorage.setItem("email",this.authenticationResponse.data.EMAIL),200==this.authenticationResponse.status?this.$router.push({path:"/dashboard"}):alert("The credentials are wrong!")}},async doRegister(){if(""===this.usernameRegistration||""===this.passwordRegistration||""===this.confirmPassword||null==this.usernameRegistration||null==this.passwordRegistration||null==this.confirmPassword||""==this.email||null==this.email)this.emptyFields=!0;else if(this.password!=this.confirmPassword)alert("Password diverse");else{let t={email:this.email,username:this.username,password:this.password};await L.createUser(t).then((t=>{this.authenticationResponse=t})).catch((function(t){console.log(t)})),console.log("print repsonse"),console.log(this.authenticationResponse),console.log(this.authenticationResponse.data["x-access-token"]);let e=this.authenticationResponse.data["x-access-token"];localStorage.setItem("token",e),console.log(this.authenticationResponse.data.ID,this.authenticationResponse.data.USERNAME),localStorage.setItem("id",this.authenticationResponse.data.ID),localStorage.setItem("username",this.authenticationResponse.data.USERNAME),localStorage.setItem("email",this.authenticationResponse.data.EMAIL),200==this.authenticationResponse.status?this.$router.push({path:"/dashboard"}):alert("Sorry! there is an error")}}},computed:{}},A=I,x=(0,p.Z)(A,j,w,!1,null,"71fb77dc",null),R=x.exports,M=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("card",[o("div",{staticClass:"container"},[o("h2",[t._v("My trips")]),o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("button",{staticClass:"btn gradient d-block"},[o("router-link",{staticStyle:{color:"white","text-decoration":"none"},attrs:{to:"modifica-viaggio"}},[t._v("Add trip")])],1)])]),o("div",{staticClass:"row"},[o("div",{staticClass:"col map"},[t.dataLoaded?o("Map",{attrs:{pathJson:t.pathJson}}):t._e()],1)]),o("div",{staticClass:"row"},[o("table",{staticClass:"table"},[o("thead",[o("tr",[o("th"),o("th",[t._v("Date")]),o("th",[t._v("Place")]),o("th",[t._v("Transportation")]),o("th",[t._v("Main Stages")])])]),o("tbody",t._l(t.tripList,(function(e){return o("tr",{key:e.ID,staticClass:"colored"},[o("td",[o("router-link",{attrs:{to:"modifica-viaggio?idTrip="+e.ID}},[o("b-icon",{attrs:{icon:"pencil"}})],1)],1),o("td",[t._v(t._s(t.getDate(e.DATE)))]),o("td",[t._v(t._s(e.PLACE))]),o("td",[t._v(t._s(e.TRANSPORTATION))]),o("td",[o("ul",{staticStyle:{"list-style-type":"none"}},t._l(e.MAIN_STAGES,(function(e,a){return o("li",{key:a},[t._v(" "+t._s(e.NAME_STAGE)+" ")])})),0)])])})),0)])])])])],1)},z=[],J=o(381),G=o.n(J),$=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"constainer justify-content-center"},[o("l-map",{ref:"map",staticStyle:{height:"600px",width:"100%"},attrs:{zoom:t.zoom,center:t.center}},[o("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}})],1)],1)])},D=[],U=o(5243),Z=o(5352),Y=o(2727),F={props:{pathJson:Object},name:"map-component",components:{LMap:Z.Z,LTileLayer:Y.Z},data(){return{map:null,url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',zoom:10,markerLatLng:[45.859412,13.601074],center:[45.65052568917208,13.76517096104127],allMarkers:[],allPolylines:[],bounds:(0,U.latLngBounds)({lat:51.476483373501964,lng:-.14668464136775586},{lat:51.52948330894063,lng:-.019140238291583955})}},methods:{alert(t){alert("Luogo: "+JSON.stringify(t))},loadMap(){this.map=this.$refs.map.mapObject;let t=(new U.FeatureGroup).addTo(this.map);function e(e,o){t.addLayer(o)}if(console.log("carico pathjson"),console.log(this.pathJson),this.pathJson.length>0)for(let o=0;o<this.pathJson.length;++o)U.geoJson(this.pathJson[o],{onEachFeature:e,color:"red"}).addTo(this.map)}},mounted(){this.loadMap()}},V=F,q=(0,p.Z)(V,$,D,!1,null,null,null),B=q.exports;const H="/WPTripExamProject/api/";var W={async getAllTrips(t,e){return N().get(H+t+"/trips/",{headers:{"x-access-token":e}})},async getTrip(t,e,o){return N().get(H+t+"/trips/"+e,{headers:{"x-access-token":o}})},async createTrip(t,e,o){return N().post(H+t+"/trips/",JSON.stringify(o),{headers:{"Content-type":"application/json","x-access-token":e}})},async updateTrip(t,e,o,a){return N().put(H+t+"/trips/"+e,JSON.stringify(a),{headers:{"Content-type":"application/json","x-access-token":o}})},async deleteTrip(t,e,o){return N()["delete"](H+t+"/trips/"+e,{headers:{"x-access-token":o}})}},X={name:"Dashboard-component",components:{Map:B},data(){return{idUser:null,username:null,tripList:null,pathJson:[],dataLoaded:!1}},mounted:function(){},beforeMount:async function(){this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token"),await this.getTrips()},methods:{getDate(t){return G()(String(t)).format("DD/MM/YYYY")},getTrips:async function(){if(await W.getAllTrips(this.idUser,this.token).then((t=>{this.tripList=t.data})).catch((function(t){console.log(t),401==t&&(console.log(t.message),localStorage.removeItem("token"),localStorage.removeItem("id"),localStorage.removeItem("username"),localStorage.removeItem("email"),this.$router.push({path:"/"}))})),console.log(this.tripList),null!=this.tripList)for(let t=0;t<this.tripList.length;++t)null!=this.tripList[t].GEOJSON&&(this.tripList[t].GEOJSON=JSON.parse(this.tripList[t].GEOJSON),console.log(this.tripList[t].GEOJSON),console.log("parse json:"),this.pathJson.push(this.tripList[t].GEOJSON));console.log("stampo pathJson"),console.log(this.pathJson),this.dataLoaded=!0}}},K=X,Q=(0,p.Z)(K,M,z,!1,null,"20be82a4",null),tt=Q.exports,et=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("main",[o("div",{staticClass:"row"},[null!=t.idTrip?o("div",{staticClass:"heading col"},[o("h2",[t._v("Update your trip of "+t._s(t.getDateDMY(t.date)))])]):o("div",{staticClass:"heading col"},[o("h2",[t._v("Add a new trip")])])]),t.dataLoaded?o("div",{staticClass:"row justify-content-center"},[o("DrawableMap",{ref:"map",attrs:{myTripGeoJSON:t.myTripGeoJSON},on:{updateCoordinates:t.updateTripCoordinates}})],1):t._e(),o("hr"),o("form",{on:{submit:function(t){t.preventDefault()}}},[o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"date"}},[t._v("Date")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.date,expression:"date"}],staticClass:"form-control",attrs:{type:"date",id:"date"},domProps:{value:t.date},on:{input:function(e){e.target.composing||(t.date=e.target.value)}}})]),o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"place"}},[t._v("Place")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.place,expression:"place"}],staticClass:"form-control",attrs:{type:"text",id:"place"},domProps:{value:t.place},on:{input:function(e){e.target.composing||(t.place=e.target.value)}}})]),o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"transportation"}},[t._v("Transportation")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.transportation,expression:"transportation"}],staticClass:"form-select",attrs:{id:"transportation"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.transportation=e.target.multiple?o:o[0]}}},[t._m(0)])])]),null!=t.myTripGeoJSON&&t.myTripGeoJSON.features.length>0?o("div",[o("h5",[t._v("Main stages")]),t._l(t.myTripGeoJSON.features,(function(e,a){return o("div",{key:a,staticClass:"mb-3"},["Point"==e.geometry.type?o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"stage_name"}},[t._v("Stage name")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.properties.name,expression:"value.properties.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.properties.name},on:{input:function(o){o.target.composing||t.$set(e.properties,"name",o.target.value)}}})]),o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"latitude"}},[t._v("Latitude")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.geometry.coordinates[1],expression:"value.geometry.coordinates[1]"}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:e.geometry.coordinates[1]},on:{input:function(o){o.target.composing||t.$set(e.geometry.coordinates,1,o.target.value)}}})]),o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"longitude"}},[t._v("Longitude")]),o("input",{directives:[{name:"model",rawName:"v-model",value:e.geometry.coordinates[0],expression:"value.geometry.coordinates[0]"}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:e.geometry.coordinates[0]},on:{input:function(o){o.target.composing||t.$set(e.geometry.coordinates,0,o.target.value)}}})])]):t._e()])}))],2):t._e(),o("div",{staticClass:"row margin-button"},[null!=t.idTrip?o("div",{staticClass:"col"},[o("button",{staticClass:"btn btn-danger w-100",attrs:{type:"button"},on:{click:function(e){return t.deleteTrip()}}},[t._v(" Delete trip ")])]):t._e(),o("div",{staticClass:"col"},[o("button",{staticClass:"btn gradient w-100",attrs:{type:"button"},on:{click:function(e){return t.saveTrip()}}},[t._v(" Save ")])])]),o("div",{staticClass:"row margin-button"},[o("div",{staticClass:"col"},[o("router-link",{staticClass:"btn gradient w-100",attrs:{to:"/dashboard"}},[t._v("Go back")])],1)])])])},ot=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("optgroup",{attrs:{label:"Choose transportation"}},[o("option",{attrs:{value:"Bike"}},[t._v("Bike")]),o("option",{attrs:{value:"Bus"}},[t._v("Bus")]),o("option",{attrs:{value:"Car"}},[t._v("Car")]),o("option",{attrs:{value:"Motorcycle"}},[t._v("Motorcycle")]),o("option",{attrs:{value:"On foot"}},[t._v("On foot")]),o("option",{attrs:{value:"Plane"}},[t._v("Place")]),o("option",{attrs:{value:"Train"}},[t._v("Train")])])}],at=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("div",{staticClass:"row justify-content-center",attrs:{id:"map"}},[o("l-map",{ref:"map",staticStyle:{height:"500px",width:"100%"},attrs:{zoom:t.zoom,center:t.center},on:{"update:zoom":t.zoomUpdated,"update:center":t.centerUpdated,"update:bounds":t.boundsUpdated}},[o("l-tile-layer",{ref:"layer",attrs:{url:t.url}})],1)],1)])},st=[],it=(o(4607),o(3693),{props:{myTripGeoJSON:Object},components:{},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",map:null,drawnItems:null,zoom:10,center:[45.859412,13.601074],bounds:null,tileLayer:null,caller:null,geoJsonText:""}},mounted(){this.drawnItems=this.initMap(),console.log("SONO IN MOUNTED"),this.$emit("update_myTripGeoJSON",this.drawnItems.toGeoJSON())},methods:{zoomUpdated(t){this.zoom=t},centerUpdated(t){this.center=t},boundsUpdated(t){this.bounds=t},initMap(){this.map=this.$refs.map.mapObject;let t=(new U.FeatureGroup).addTo(this.map);console.log(t),this.map.addLayer(t);let e=this;function o(e,o){t.addLayer(o)}console.log(this.myTripGeoJSON),null==this.myTripGeoJSON||"undefined"===this.myTripGeoJSON?console.log("myTripGeoJSOn null or undefined"):0!=Object.entries(this.myTripGeoJSON).length&&U.geoJson(this.myTripGeoJSON,{onEachFeature:o,color:"red"}).addTo(this.map),console.log("drawnItems.toGeoJSON()"),console.log(t.toGeoJSON()),this.map.pm.addControls({position:"topleft",custom:"prop",drawMarker:!0,drawPolyline:{snapDistance:5},drawRectangle:!1,drawPolygon:!1,drawCircleMarker:!1,drawCircle:!1,drawText:!1,rotateMode:!1,dragMode:!1,cutPolygon:!1});let a=this.getPath(t);function s(e){let o=e.layer;o.addTo(t);let a=JSON.stringify(o.toGeoJSON(),null,4);this.geoJsonText=a.toString(),console.log("geoJsonText"),console.log(this.geoJsonText)}return console.log(a),this.map.on("pm:create",(function(o){console.log("Pm:create"),console.log(o);let s=o.layer;console.log(s);let i=s.feature=s.feature||{};if(i.type="Feature",i.properties=i.properties||{},i.properties["name"]="",console.log(s),console.log(s.pm._shape),"Line"===s.pm._shape){console.log(t.toGeoJSON()),t.addLayer(s);let o=t.toGeoJSON().features;a=o.filter((t=>"LineString"===t.geometry.type)),console.log(a),a.length>1?(console.log("ERORRE: NON PUò ESSERCI PIU DI UN PERCORSO!!"),alert("ERORRE: NON PUò ESSERCI PIU DI UN PERCORSO!!"),t.removeLayer(s)):e.$emit("updateCoordinates",t.toGeoJSON())}else console.log(a),console.log("lat e long marker"),console.log(s.toGeoJSON()),null!=a&&a.length>0?(console.log("check if marker is on line"),console.log(`layer._latlng.lng = ${s._latlng.lng}, layer._latlng.lat = ${s._latlng.lat}`),console.log("MANDO COORDINATE A PARENT COMPONENT"),t.addLayer(s),e.$emit("updateCoordinates",t.toGeoJSON())):(t.addLayer(s),console.log(t.toGeoJSON()),e.$emit("updateCoordinates",t.toGeoJSON()))})),t.on("pm:edit",(function(){console.log("pm:edit on drawnItems"),console.log(t.toGeoJSON()),e.$emit("updateCoordinates",t.toGeoJSON())})),t.on("pm:remove",(o=>{console.log("pm:remove"),console.log(t.toGeoJSON()),t.removeLayer(o.layer),e.$emit("updateCoordinates",t.toGeoJSON())})),this.map.addEventListener("pm:create",s),t},updateCoordinates(t){console.log("called emitToParent"),console.log(t),this.$emit("updateCoordinates",this.drawnItems.toGeoJSON())},getPath(t){let e=t.toGeoJSON().features,o=e.filter((t=>"LineString"===t.geometry.type));return console.log("path"),console.log(o),o},getMainStages(t){let e=t.toGeoJSON().features,o=e.filter((t=>"Point"===t.geometry.type));console.log("points"),console.log(o);let a=[];for(let s=0;s<o.length;++s)a.push([o[s].geometry.coordinates[1],o[s].geometry.coordinates[0]]);console.log(a)}}}),nt=it,rt=(0,p.Z)(nt,at,st,!1,null,"7fff6d5a",null),lt=rt.exports,ct={name:"ModificaViaggio",components:{DrawableMap:lt},data(){return{date:null,place:null,transportation:null,path:[],latitude:null,longitude:null,stage:null,mainStages:[],pathCoordinates:[],polylines:[],markers:[],showModal:!1,luogo_modal:null,latitudine_modal:null,longitudine_modal:null,i:null,showUpdatemainStages:!1,trip:[],myTripGeoJSON:null,idUser:null,username:null,token:null,idTrip:null,dataLoaded:!1}},mounted(){},beforeMount:async function(){this.idTrip=this.$route.query.idTrip,this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token"),null!=this.$route.query.idTrip?(console.log(`idTrip = ${this.$route.query.idTrip}`),await this.loadTrip()):(this.dataLoaded=!0,console.log(`idTrip = ${this.$route.query.idTrip}`))},methods:{deleteTrip:async function(){let t;await W.deleteTrip(this.idUser,this.idTrip,this.token).then((e=>{t=e})).catch((function(t){console.log(t)})),console.log(t)},getTappa:function(t){this.i=t,this.showModal=!0,console.log(this.mainStages[t]),this.luogo_modal=this.mainStages[t].STAGE_NAME,this.latitudine_modal=this.mainStages[t].LAT,this.longitudine_modal=this.mainStages[t].LNG,console.log(`luogo_modal: ${this.luogo_modal}, lat_modal: ${this.latitudine_modal}, lgn_modal: ${this.longitudine_modal}`)},getDate(t){return G()(String(t)).format("YYYY-MM-DD")},getDateDMY(t){return G()(String(t)).format("DD/MM/YYYY")},loadTrip:async function(){await W.getTrip(this.idUser,this.idTrip,this.token).then((t=>{this.trip=t})).catch((function(t){console.log(t)})),console.log("created: after get trip"),console.log("trip:"),console.log(this.trip),this.trip=this.trip.data,console.log(this.trip),this.date=this.trip.DATE,this.place=this.trip.PLACE,this.transportation=this.trip.TRANSPORTATION,this.myTripGeoJSON=JSON.parse(this.trip.GEOJSON),console.log(this.myTripGeoJSON),this.getMainStagesAndPathCoordinate(),this.dataLoaded=!0},saveTrip:async function(){let t,e;null==this.idTrip?(console.log(`id null? == ${this.idTrip}`),t={PLACE:this.place,TRANSPORTATION:this.transportation,GEOJSON:JSON.stringify(this.myTripGeoJSON),DATE:this.date,USER:this.idUser},console.log("stampo json trip"),console.log(JSON.stringify(t)),await W.createTrip(this.idUser,this.token,t).then((t=>{e=t})).catch((function(t){console.log(t)})),console.log(e)):(console.log(`idTrip = ${this.idTrip}`),t={ID:this.idTrip,PLACE:this.place,TRANSPORTATION:this.transportation,GEOJSON:JSON.stringify(this.myTripGeoJSON),DATE:this.date,USER:this.idUser},console.log("stampo json trip"),console.log(JSON.stringify(t)),await W.updateTrip(this.idUser,this.idTrip,this.token,t).then((t=>{e=t})).catch((function(t){console.log(t)})),console.log(e))},getMainStagesAndPathCoordinate(){this.mainStages=[],this.pathCoordinates=[];let t=this.myTripGeoJSON.features;for(let e=0;e<this.myTripGeoJSON.features.length;++e)if("Point"===t[e].geometry.type)this.mainStages.push(t[e]);else if("LineString"===t[e].geometry.type){let o=t[e].geometry.coordinates;for(let a=0;a<o.length;++a)this.pathCoordinates.push(t[e])}console.log("mainStages"),console.log(this.mainStages),console.log("pathCoordinates"),console.log(this.pathCoordinates)},updateTripCoordinates(t){console.log("update cooridnates of my trip"),console.log(t),this.myTripGeoJSON=t,console.log(" updated mytripJSON"),console.log(this.myTripGeoJSON),this.getMainStagesAndPathCoordinate()}}},pt=ct,dt=(0,p.Z)(pt,et,ot,!1,null,"59291344",null),ut=dt.exports,mt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("Header"),o("main",[o("div",{staticClass:"row"},[null!=t.id?o("div",{staticClass:"heading col"},[o("h2",[t._v("Modifica il tuo viaggio del "+t._s(t.getDateDMY(t.data)))])]):o("div",{staticClass:"heading col"},[o("h2",[t._v("Aggiungi viaggio")])])]),o("div",{staticClass:"row justify-content-center"},[o("l-map",{ref:"map",staticStyle:{height:"400px",width:"100%"},attrs:{zoom:t.zoom,center:t.center}},[t._l(t.markers,(function(e,a){return o("l-marker",{key:a,attrs:{draggable:e.draggable,"lat-lng":e.POSIZIONE,icon:e.icon},on:{"update:latLng":function(o){return t.$set(e,"POSIZIONE",o)},"update:lat-lng":function(o){return t.$set(e,"POSIZIONE",o)},click:function(o){return t.alert(e.tooltip)}}})})),o("l-polyline",{attrs:{"lat-lngs":t.polylines}})],2)],1),o("hr"),o("input",{staticClass:"btn gradient w-50",attrs:{type:"button",value:"AGGIORNA PERCORSO"},on:{click:function(e){return t.createPath()}}}),o("form",{on:{submit:function(t){t.preventDefault()}}},[o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"data"}},[t._v("Data")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.data,expression:"data"}],staticClass:"form-control",attrs:{type:"date",id:"data"},domProps:{value:t.data},on:{input:function(e){e.target.composing||(t.data=e.target.value)}}})]),o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"luogo"}},[t._v("Luogo")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.luogo,expression:"luogo"}],staticClass:"form-control",attrs:{type:"text",id:"luogo"},domProps:{value:t.luogo},on:{input:function(e){e.target.composing||(t.luogo=e.target.value)}}})]),o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"mezzo"}},[t._v("Mezzo")]),o("select",{directives:[{name:"model",rawName:"v-model",value:t.mezzo,expression:"mezzo"}],staticClass:"form-select",attrs:{id:"mezzo"},on:{change:function(e){var o=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.mezzo=e.target.multiple?o:o[0]}}},[t._m(0)])]),o("div",{staticClass:"mb-3"},[o("div",{staticClass:"row"},[o("h5",[t._v("Punto di partenza")]),o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"lat"}},[t._v("Latitudine")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.partenza_latitudine,expression:"partenza_latitudine"}],staticClass:"form-control",attrs:{id:"lat",type:"text"},domProps:{value:t.partenza_latitudine},on:{input:function(e){e.target.composing||(t.partenza_latitudine=e.target.value)}}})]),o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"lat"}},[t._v("Longitudine")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.partenza_longitudine,expression:"partenza_longitudine"}],staticClass:"form-control",attrs:{id:"lat",type:"text"},domProps:{value:t.partenza_longitudine},on:{input:function(e){e.target.composing||(t.partenza_longitudine=e.target.value)}}})])])]),o("div",{staticClass:"mb-3"},[o("div",{staticClass:"row"},[o("h5",[t._v("Punto di arrivo")]),o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"lat"}},[t._v("Latitudine")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.arrivo_latitudine,expression:"arrivo_latitudine"}],staticClass:"form-control",attrs:{id:"lat",type:"text"},domProps:{value:t.arrivo_latitudine},on:{input:function(e){e.target.composing||(t.arrivo_latitudine=e.target.value)}}})]),o("div",{staticClass:"col"},[o("label",{staticClass:"form-label",attrs:{for:"lat"}},[t._v("Longitudine")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.arrivo_longitudine,expression:"arrivo_longitudine"}],staticClass:"form-control",attrs:{id:"lat",type:"text"},domProps:{value:t.arrivo_longitudine},on:{input:function(e){e.target.composing||(t.arrivo_longitudine=e.target.value)}}})])])])]),o("h5",[t._v("Tappe Principali")]),t.tappe.length>0?o("div",[o("p",{staticStyle:{"font-size":"13px"}},[t._v(" (Trascinare le righe della tabella per ordinare il percorso) ")]),o("table",{staticClass:"table"},[t._m(1),o("draggable",{staticStyle:{cursor:"move"},attrs:{tag:"tbody"},on:{change:function(e){return t.updateValues()}},model:{value:t.tappe,callback:function(e){t.tappe=e},expression:"tappe"}},t._l(t.tappe,(function(e,a){return o("tr",{key:a,staticClass:"colored"},[o("td",[o("b-icon",{attrs:{icon:"arrows-move"}})],1),o("td",[t._v(t._s(e.LUOGO_TAPPA))]),o("td",[t._v(t._s(e.POSIZIONE.lat))]),o("td",[t._v(t._s(e.POSIZIONE.lng))]),o("td",[o("button",{staticClass:"btn gradient",on:{click:function(e){return t.getTappa(a)}}},[o("b-icon",{attrs:{icon:"pencil"}})],1)]),o("td",[o("button",{staticClass:"btn gradient",on:{click:function(e){return t.removeMarker(a)}}},[t._v(" X ")])])])})),0)],1)]):t._e(),o("div",{staticClass:"mb-3"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("button",{staticClass:"btn gradient d-block w-45",staticStyle:{float:"right"},attrs:{type:"button"},on:{click:function(e){return t.addMarker()}}},[t._v(" Aggiungi tappa ")])])])]),o("div",{staticClass:"mb-3"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col"},[o("router-link",{staticClass:"btn gradient d-block w-100",attrs:{to:"/dashboard"}},[t._v("Indietro")])],1),o("div",{staticClass:"col"},[o("button",{staticClass:"btn gradient d-block w-100",attrs:{type:"button"},on:{click:function(e){return t.saveTrip()}}},[t._v(" Salva ")])])])]),o("b-modal",{staticStyle:{opacity:"0.5"},attrs:{size:"lg"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var a=e.close;return[o("b-button",{staticStyle:{background:"#00467f"},attrs:{size:"sm"},on:{click:function(t){return a()}}},[t._v("X")]),o("h3",[t._v("Modifica Tappa")])]}},{key:"modal-footer",fn:function(e){var a=e.cancel;return[o("span",{staticStyle:{"padding-left":"40px"}},[o("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(t){return a()}}},[t._v("CHIUDI")])],1),o("span",{staticStyle:{"padding-right":"40px"}},[o("b-button",{staticStyle:{background:"#00467f"},attrs:{size:"sm"},on:{click:function(e){return t.updateTappa()}}},[t._v("SALVA MODIFICHE")])],1)]}}]),model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[[o("form",[o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"luogo"}},[t._v("Luogo tappa")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.luogo_modal,expression:"luogo_modal"}],staticClass:"form-control",attrs:{type:"text",id:"luogo"},domProps:{value:t.luogo_modal},on:{input:function(e){e.target.composing||(t.luogo_modal=e.target.value)}}})]),o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"latitudine"}},[t._v("Latitude")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.latitudine_modal,expression:"latitudine_modal"}],staticClass:"form-control",attrs:{type:"text",id:"latitudine"},domProps:{value:t.latitudine_modal},on:{input:function(e){e.target.composing||(t.latitudine_modal=e.target.value)}}})]),o("div",{staticClass:"mb-3"},[o("label",{staticClass:"form-label",attrs:{for:"longitudine"}},[t._v("Longitude")]),o("input",{directives:[{name:"model",rawName:"v-model",value:t.longitudine_modal,expression:"longitudine_modal"}],staticClass:"form-control",attrs:{type:"text",id:"longitudine"},domProps:{value:t.longitudine_modal},on:{input:function(e){e.target.composing||(t.longitudine_modal=e.target.value)}}})])])]],2)],1),o("Footer")],1)},gt=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("optgroup",{attrs:{label:"Scegli un mezzo di trasporto"}},[o("option",{attrs:{value:"Aereo"}},[t._v("Aereo")]),o("option",{attrs:{value:"Auto"}},[t._v("Auto")]),o("option",{attrs:{value:"Autobus"}},[t._v("Autobus")]),o("option",{attrs:{value:"A piedi"}},[t._v("A piedi")]),o("option",{attrs:{value:"Bici"}},[t._v("In bici")]),o("option",{attrs:{value:"Moto"}},[t._v("Moto")]),o("option",{attrs:{value:"Treno"}},[t._v("Treno")])])},function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("thead",[o("tr",[o("th"),o("th",[t._v("Luogo tappa")]),o("th",[t._v("Latitudine")]),o("th",[t._v("Longitudine")]),o("th",[t._v("Modifica")]),o("th",[t._v("Rimuovi")])])])}],ht=o(629),vt=o(9980),ft=o.n(vt),yt=o(8380),_t=o(6595),bt={name:"ModificaViaggio",components:{Header:u,Footer:y,draggable:ft(),LMap:Z.Z,LMarker:yt.Z,LPolyline:_t.Z},data(){return{id:null,data:null,luogo:null,mezzo:null,percorso:[],latitudine:null,longitudine:null,tappa:null,partenza_latitudine:null,partenza_longitudine:null,arrivo_latitudine:null,arrivo_longitudine:null,tappe:[],polylines:[],markers:[],showModal:!1,luogo_modal:null,latitudine_modal:null,longitudine_modal:null,i:null,showUpdateTappe:!1,trip:[],url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',zoom:8,center:[45.65052568917208,13.76517096104127],markerLatLng:[51.505,-.09],bounds:(0,U.latLngBounds)({lat:51.476483373501964,lng:-.14668464136775586},{lat:51.52948330894063,lng:-.019140238291583955})}},methods:{...(0,ht.nv)(["addTrip","addNewTrip","getTrip","updateTrip"]),alert(t){alert("Luogo: "+JSON.stringify(t))},addMarker:function(){if(console.log(this.tappe),this.tappe.length<1){const t={POSIZIONE:{lat:45.65052568917208,lng:13.76517096104127},LUOGO_TAPPA:"nuova tappa",draggable:!0,visible:!0};this.tappe.push(t),this.polylines.push(t.POSIZIONE)}else{const t=this.tappe[this.tappe.length-1];console.log(t);const e={POSIZIONE:{lat:t.POSIZIONE.lat,lng:t.POSIZIONE.lng},LUOGO_TAPPA:"nuova tappa",draggable:!0,visible:!0};this.tappe.push(e),this.polylines.push(e.POSIZIONE)}this.$store.state.markers=this.tappe,this.$store.state.polylines=this.polylines},createPath:function(){this.markers=this.$store.state.markers,console.log(this.$store.state.markers);const t=(0,U.latLngBounds)(this.markers.map((t=>t.POSIZIONE)));this.polylines=[],this.bounds=t;for(let e=0;e<this.markers.length;++e)this.polylines[e]=this.markers[e].POSIZIONE;this.$store.state.polylines=this.polylines,console.log("crea path markers"),console.log(this.markers)},getTappa:function(t){this.i=t,this.showModal=!0,console.log(this.tappe[t]),this.luogo_modal=this.tappe[t].LUOGO_TAPPA,this.latitudine_modal=this.tappe[t].POSIZIONE.lat,this.longitudine_modal=this.tappe[t].POSIZIONE.lng,console.log(`luogo_modal: ${this.luogo_modal}, lat_modal: ${this.latitudine_modal}, lgn_modal: ${this.longitudine_modal}`)},getDate(t){return G()(String(t)).format("YYYY-MM-DD")},getDateDMY(t){return G()(String(t)).format("DD/MM/YYYY")},loadTrip:async function(){let t=await this.getTrip(this.id);console.log("creatd: after get trip"),console.log("trips:"),console.log(t),this.data=this.getDate(t.DATA),this.luogo=t.LUOGO,this.mezzo=t.MEZZO,this.percorso=t.PERCORSO,this.partenza_latitudine=this.percorso.PARTENZA_LAT,this.partenza_longitudine=this.percorso.PARTENZA_LNG,this.arrivo_latitudine=this.percorso.ARRIVO_LAT,this.arrivo_longitudine=this.percorso.ARRIVO_LNG,console.log(`p_lat: ${this.partenza_latitudine}, p_lng: ${this.partenza_longitudine}, a_lat: ${this.arrivo_latitudine}, a_lng: ${this.arrivo_longitudine}`),this.tappe=t.TAPPE_PRINCIPALI,console.log("load, tappe:"),console.log(this.tappe);for(let e=0;e<this.tappe.length;++e)this.polylines[e]=this.tappe[e].POSIZIONE;console.log("load, polylines:"),console.log(this.polylines),this.updateValues(),this.createPath()},removeMarker:function(t){this.tappe.splice(t,1),this.polylines.splice(t,1)},saveTrip:async function(){let t;this.percorso={PARTENZA_LAT:this.partenza_latitudine,PARTENZA_LNG:this.partenza_longitudine,ARRIVO_LAT:this.arrivo_latitudine,ARRIVO_LNG:this.arrivo_longitudine},null==this.id?(console.log(`id null? == ${this.id}`),t={LUOGO:this.luogo,MEZZO:this.mezzo,PERCORSO:this.percorso,TAPPE_PRINCIPALI:this.tappe,DATA:this.data},console.log("stampo json trip"),console.log(JSON.stringify(t)),this.addNewTrip(JSON.stringify(t))):(console.log(`id == ${this.id}`),t={ID:this.id,LUOGO:this.luogo,MEZZO:this.mezzo,PERCORSO:this.percorso,TAPPE_PRINCIPALI:this.tappe,DATA:this.data},console.log("stampo json trip"),console.log(JSON.stringify(t)),this.updateTrip(JSON.stringify(t)))},updateTappa:function(){console.log(this.tappe[this.i]),this.tappe[this.i].LUOGO_TAPPA=this.luogo_modal,this.tappe[this.i].POSIZIONE.lat=this.latitudine_modal,this.tappe[this.i].POSIZIONE.lng=this.longitudine_modal,this.showModal=!1,this.createPath()},updateValues:function(){console.log("update values modifica viaggio"),this.$store.state.markers=this.tappe,console.log(this.$store.state.markers),this.$store.state.polylines=this.polylines,this.createPath()}},computed:{...(0,ht.Se)(["markersList","polylineList","singleTrip"])},async mounted(){console.log("mounted")},async created(){this.id=this.$route.query.id,console.log("creatd: before get trip"),null!=this.id?this.loadTrip():console.log("inserisci viaggio")}},Ot=bt,Ct=(0,p.Z)(Ot,mt,gt,!1,null,"4196e3ea",null),St=Ct.exports,jt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},wt=[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"container"},[o("p",[t._v("ERRORE")])])}],Tt={name:"errore-component",components:{},data(){return{}},methods:{}},Nt=Tt,kt=(0,p.Z)(Nt,jt,wt,!1,null,null,null),Pt=kt.exports,Lt=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticClass:"row justify-content-center",attrs:{id:"map"}}),o("div",[t._v("zoom: "+t._s(t.zoom)+", center: "+t._s(t.center))])])},Et=[],It={components:{},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",map:null,zoom:10,center:[40.026534098506396,32.78335332870484],bounds:null,drawToolbarOptions:{},tileLayer:null,newMarker:null,caller:null,markers:[{lat:40.026534098506396,lng:32.78335332870484}],pathCoordinates:null,mainStages:[],geojson:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Line",coordinates:[[-41.31115,174.80827],[-41.30928,174.80835],[-41.29127,174.83841],[41,55]]}},{type:"line",coordinates:[[-41,174],[110,45],[41,55]]}]}}},mounted(){this.initMap(),this.onClick()},methods:{zoomUpdated(t){this.zoom=t},centerUpdated(t){this.center=t},boundsUpdated(t){this.bounds=t},openPopUp(t,e){this.caller=e,console.log("open")},initMap(){this.map=U.map("map").setView([40.0269319,32.83604819],13),this.tileLayer=U.tileLayer(this.url,{continuousWorld:!1,noWrap:!1,crs:U.CRS.Simple}).addTo(this.map),this.map.on("pm:drawedited",(function(t){console.log(t);var e=t.layers;e.eachLayer((function(t){console.log(t)}))})),this.map.pm.addControls({position:"topright",drawCircle:!1,drawCircleMarker:!1,drawRectangle:!1,drawPolygon:!1,cutPolygon:!1,rotateMode:!1,oneBlock:!1}),this.map.on("click",this.onClick,this),this.map.pm.setPathOptions({color:"green"});for(let t=0;t<this.markers.length;t++)U.marker(this.markers[t]).addTo(this.map);return console.log(this.map.pm.getGlobalOptions()),this.map},onClick(){let t=[];this.map.on("pm:drawstart",(({workingLayer:e})=>{console.log("workingLsyer"),console.log(e),e.on("pm:vertexadded",(e=>{console.log(e),t.push({lat:e.latlng.lat,lng:e.latlng.lng})})),this.map.on("pm:drawend",(function(t){let e=t.shape;console.log(`shape: ${e}`)}))})),this.map.on("pm:snap",(function(t){console.log("snap"),console.log(t)})),this.map.on("pm:unsnap",(function(t){console.log("unsnap"),console.log(t)}))},onMapUpdate(){this.map.on("pm:drawstart",(({workingLayer:t})=>{t.on("pm:vertexadded",(t=>{console.log(t)}))})),this.map.on("pm:create",(function(t){console.log(t),console.log(this.markers);const e=t.layer;e.on("pm:cut",(function(t){console.log("cut event on layer"),console.log(t)}))}))}}},At=It,xt=(0,p.Z)(At,Lt,Et,!1,null,"2c9f13f2",null),Rt=xt.exports;a["default"].use(S.Z);const Mt=[{path:"/prova-mappa",name:"provaMappa",component:Rt},{path:"/login",name:"Login",component:R},{path:"/",name:"Login",component:R},{path:"/dashboard",name:"Dashboard",component:tt},{path:"/modifica-viaggio",name:"ModificaViaggio",component:ut},{path:"/modifica-viaggio-vecchio",name:"ModificaViaggioVecchio",component:St},{path:"/*",name:"Errore",component:Pt}],zt=new S.Z({mode:"history",base:"/WPTripExamProject/",routes:Mt});var Jt=zt;a["default"].use(ht.ZP);var Gt=new ht.ZP.Store({state:{},getters:{},mutations:{},actions:{},modules:{}}),$t=(o(7244),o(5069)),Dt=o(3017);a["default"].config.productionTip=!1,a["default"].use($t.XG7),a["default"].use(Dt.X),a["default"].component("l-map",Z.Z),a["default"].component("l-tile-layer",Y.Z),a["default"].component("l-marker",yt.Z),delete U.Icon.Default.prototype._getIconUrl,U.Icon.Default.mergeOptions({iconRetinaUrl:o(6431),iconUrl:o(7093),shadowUrl:o(8858)}),new a["default"]({router:Jt,store:Gt,render:t=>t(C),Base:"/ WPTripExam /",mode:"history"}).$mount("#app")}},e={};function o(a){var s=e[a];if(void 0!==s)return s.exports;var i=e[a]={id:a,loaded:!1,exports:{}};return t[a].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}o.m=t,function(){var t=[];o.O=function(e,a,s,i){if(!a){var n=1/0;for(p=0;p<t.length;p++){a=t[p][0],s=t[p][1],i=t[p][2];for(var r=!0,l=0;l<a.length;l++)(!1&i||n>=i)&&Object.keys(o.O).every((function(t){return o.O[t](a[l])}))?a.splice(l--,1):(r=!1,i<n&&(n=i));if(r){t.splice(p--,1);var c=s();void 0!==c&&(e=c)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[a,s,i]}}(),function(){o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,{a:e}),e}}(),function(){o.d=function(t,e){for(var a in e)o.o(e,a)&&!o.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){o.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={143:0};o.O.j=function(e){return 0===t[e]};var e=function(e,a){var s,i,n=a[0],r=a[1],l=a[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(s in r)o.o(r,s)&&(o.m[s]=r[s]);if(l)var p=l(o)}for(e&&e(a);c<n.length;c++)i=n[c],o.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return o.O(p)},a=self["webpackChunkmytrips_exam"]=self["webpackChunkmytrips_exam"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=o.O(void 0,[998],(function(){return o(1063)}));a=o.O(a)})();
//# sourceMappingURL=app.b310cffd.js.map