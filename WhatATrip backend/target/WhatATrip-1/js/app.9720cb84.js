(function(){"use strict";var t={7282:function(t,e,a){var i=a(144),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t.$route.meta.hideHeader?t._e():a("Header"),a("div",{staticClass:"content"},[a("router-view")],1),t.$route.meta.hideHeader?t._e():a("Footer",{attrs:{id:"footer"}})],1)},o=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"app"}},[i("nav",{staticClass:"navbar navbar-dark navbar-expand-lg fixed-top bg-white portfolio-navbar myNavbar"},[i("div",{staticClass:"container"},[i("router-link",{staticClass:"navbar-brand logo",attrs:{to:"/welcome"}},[i("img",{staticStyle:{width:"25%"},attrs:{src:a(8923),alt:"What a trip logo"}}),t._v(" What a trip ")]),t._m(0),i("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarNav"}},[i("ul",{staticClass:"navbar-nav ms-auto"},["admin"===t.userRole?i("li",{staticClass:"nav-item"},[i("router-link",{staticClass:"nav-link active",attrs:{to:"admin-dashboard"}},[i("b-icon",{attrs:{icon:"person-fill"}})],1)],1):t._e(),i("li",{staticClass:"nav-item"},[i("router-link",{staticClass:"nav-link active",attrs:{to:"dashboard"}},[t._v("Home")])],1),i("li",{staticClass:"nav-item"},[i("router-link",{staticClass:"nav-link active",attrs:{to:"/about"}},[t._v("About")])],1),i("li",{staticClass:"nav-item"},[i("span",{staticClass:"nav-link active",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.logout()}}},[t._v("Logout")])])])])],1)]),i("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var a=e.close;return[i("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return a()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var a=e.ok;return[i("span",{staticStyle:{"padding-right":"40px"}},[i("b-button",{staticClass:"orange-color",on:{click:function(t){return a()}}},[t._v("OK")])],1)]}}]),model:{value:t.showLoaderLogout,callback:function(e){t.showLoaderLogout=e},expression:"showLoaderLogout"}},[[i("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Thanks, bye! ")]),i("div",{staticClass:"row justify-content-center"},[t.showLoaderLogout?i("div",{staticClass:"loader"},[i("div",{staticClass:"ball"}),i("div",{staticClass:"ball"}),i("div",{staticClass:"ball"})]):t._e()])]],2)],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"navbar-toggler",attrs:{"data-bs-toggle":"collapse","data-bs-target":"#navbarNav"}},[a("span",{staticClass:"visually-hidden"},[t._v("Toggle navigation")]),a("span",{staticClass:"navbar-toggler-icon"})])}],l=a(9669),d=a.n(l);const c="/WhatATrip/api/user";var p={async createUser(t){return d().post(c+"/create",JSON.stringify(t),{headers:{"Content-type":"application/json"}})},async authenticateUser(t){return d().post(c+"/authenticate",JSON.stringify(t),{headers:{"Content-type":"application/json"}})},async getAllUsers(t){return d().get(c+"/getAll",{headers:{"Content-type":"application/json","x-access-token":t}})},async getUsername(t){return d().get(c+"/get",{headers:{"Content-type":"application/json","x-access-token":t}})},async logout(t){return localStorage.removeItem("token"),localStorage.removeItem("id"),localStorage.removeItem("username"),localStorage.removeItem("email"),localStorage.removeItem("role"),localStorage.setItem("isLogged",!1),d()["delete"](c+"/logout",{headers:{"Content-type":"application/json","x-access-token":t}})}},u={name:"Header-component",props:{},data(){return{showLoaderLogout:!1,userRole:null,id:null,token:null}},methods:{logout:async function(){this.showLoaderLogout=!0,setTimeout((()=>{p.logout(this.token),this.$router.push({path:"/login"})}),2e3)}},mounted(){this.userRole=localStorage.getItem("role"),this.token=localStorage.getItem("token"),this.id=localStorage.getItem("id")}},h=u,m=a(1001),v=(0,m.Z)(h,r,n,!1,null,"157c96b6",null),g=v.exports,f=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},w=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("footer",{staticClass:"page-footer footer"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col-sm"},[i("img",{staticClass:"units_logo",attrs:{src:a(9620),alt:"University of Trieste logo"}})]),i("div",{staticClass:"col-sm"},[t._v(" Contact: "),i("a",{attrs:{href:"mailto:samantha.gallone@gmail.com"}},[t._v("samantha.gallone@gmail.com")])])])])}],y={name:"Footer-component",props:{}},_=y,b=(0,m.Z)(_,f,w,!1,null,null,null),C=b.exports,S={name:"Dashboard-component",components:{Header:g,Footer:C}},L=S,k=(0,m.Z)(L,s,o,!1,null,null,null),E=k.exports,x=a(8345),T=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},R=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container my-margin",attrs:{id:"app"}},[a("section",[a("h2",{staticClass:"titles"},[t._v("Specification of the project and technologies used")]),a("p",[t._v(" The goal of this project was to realize a web application where a registered user can save information about his trips. The users will have to login into the platform and then he will be able to see all his trips and create more of them. Each trip has a date, a transportation type, a path, a small description of the trip that is not mandatory, and a list of stages that can also have a name and a small description. On the home page, the user can look at all his trips, but also he can filter them based on a single date or a range of dates. A trip can be modified or deleted at any moment. A new user can create an account and in a few seconds he will be able to create his first trip. The main technologies used to realize this web application are: ")]),a("ul",[a("li",[t._v("Apache Tomcat")]),a("li",[t._v("Maven")]),a("li",[t._v("MySQL")]),a("li",[t._v("Axios")]),a("li",[t._v("Vue.js framework")]),a("li",[t._v(" Leaflet map, in particular "),a("a",{attrs:{href:"https://github.com/geoman-io/leaflet-geoman",target:"_blank"}},[t._v("leaflet-geoman plugin")])])])]),a("section",[a("h2",{staticClass:"titles"},[t._v("Future updates ideas")]),a("p",[t._v("Some possible future updates ideas are:")]),a("ul",[a("li",[t._v("add the possibility to share a trip with your trip buddy")]),a("li",[t._v(" add other types of filters, for example the possibility to filter by the type of transpotation or on the trip's buddies that did the trip with the user ")]),a("li",[t._v(" add the possibility to add also a picture for the whole trip or one in the main stages ")]),a("li",[t._v(" add the geolocalization in order to save your trip instantanely as you are moving ")]),a("li",[t._v(" add the possibility to set starting point and arrival point and get the shortest path ")]),a("li",[t._v(" add the possibility to choose for each trip the marker/path color or a marker image ")]),a("li",[t._v("create a mobile app")])])])])}],P={name:"About-component",components:{},data(){return{idUser:null,username:null}},mounted:function(){},beforeMount:async function(){this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token")},methods:{}},O=P,A=(0,m.Z)(O,T,R,!1,null,"0d1583c2",null),D=A.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"myLoginPage"},[a("div",{staticClass:"container"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-4 col-md-6 col-sm-8 mx-auto"},[t.registerActive?a("div",{staticClass:"card",class:{error:t.emptyFields}},[t._m(1),a("h2",[t._v("Sign Up")]),a("form",{on:{submit:function(t){t.preventDefault()}}},[a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.email,"is-invalid":t.validation.invalid.email},attrs:{type:"text",id:"email",placeholder:"Email",required:""},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t.validation.valid.email?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.email)+" ")]):t._e(),t.validation.invalid.email?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.email)+" ")]):t._e()]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.usernameRegistration,expression:"usernameRegistration"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.usernameRegistration,"is-invalid":t.validation.invalid.usernameRegistration},attrs:{type:"text",id:"usernameRegistration",placeholder:"Username",required:""},domProps:{value:t.usernameRegistration},on:{input:function(e){e.target.composing||(t.usernameRegistration=e.target.value)}}}),t.validation.valid.usernameRegistration?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.usernameRegistration)+" ")]):t._e(),t.validation.invalid.usernameRegistration?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.usernameRegistration)+" ")]):t._e()]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordRegistration,expression:"passwordRegistration"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.passwordRegistration,"is-invalid":t.validation.invalid.passwordRegistration},attrs:{type:"password",id:"passwordRegistration",placeholder:"Password",required:""},domProps:{value:t.passwordRegistration},on:{input:function(e){e.target.composing||(t.passwordRegistration=e.target.value)}}}),t.validation.valid.passwordRegistration?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.passwordRegistration)+" ")]):t._e(),t.validation.invalid.passwordRegistration?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.passwordRegistration)+" ")]):t._e()]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.confirmPassword,"is-invalid":t.validation.invalid.confirmPassword},attrs:{type:"password",id:"confirmPassword",placeholder:"Confirm Password",required:""},domProps:{value:t.confirmPassword},on:{input:function(e){e.target.composing||(t.confirmPassword=e.target.value)}}}),t.validation.valid.confirmPassword?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.confirmPassword)+" ")]):t._e(),t.validation.invalid.confirmPassword?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.confirmPassword)+" ")]):t._e()]),t.showCredentialsExisting?a("div",{staticClass:"form-group invalid-credentials"},[a("div",[t._v(" "+t._s(t.credentialsExistingMessage)+" ")])]):t._e(),t.showErrorMessage?a("div",{staticClass:"form-group invalid-credentials"},[a("div",[t._v(" "+t._s(t.errorMessage)+" ")])]):t._e(),a("button",{staticClass:"btn yellow-color",attrs:{type:"submit"},on:{click:function(e){return t.doRegister()}}},[t._v(" Register ")]),a("p",[t._v(" Already have an account? "),a("a",{attrs:{href:"#"},on:{click:function(e){t.registerActive=!t.registerActive,t.emptyFields=!1}}},[t._v("Sign in here")])])])]):a("div",{staticClass:"card",class:{error:t.emptyFields}},[t._m(0),a("h2",[t._v("Sign In")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.validateLogin.apply(null,arguments)}}},[a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.usernameLogin,expression:"usernameLogin"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.usernameLogin,"is-invalid":t.validation.invalid.usernameLogin},attrs:{id:"usernameLogin",type:"text",placeholder:"Username",required:""},domProps:{value:t.usernameLogin},on:{input:function(e){e.target.composing||(t.usernameLogin=e.target.value)}}}),t.validation.valid.usernameLogin?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.usernameLogin)+" ")]):t._e(),t.validation.invalid.usernameLogin?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.usernameLogin)+" ")]):t._e()]),a("div",{staticClass:"form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.passwordLogin,expression:"passwordLogin"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.passwordLogin,"is-invalid":t.validation.invalid.passwordLogin},attrs:{type:"password",id:"passwordLogin",placeholder:"Password",required:""},domProps:{value:t.passwordLogin},on:{input:function(e){e.target.composing||(t.passwordLogin=e.target.value)}}}),t.validation.valid.passwordLogin?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.passwordLogin)+" ")]):t._e(),t.validation.invalid.passwordLogin?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.passwordLogin)+" ")]):t._e()]),t.showWrongCredentials?a("div",{staticClass:"form-group invalid-credentials"},[a("div",[t._v(" "+t._s(t.wrongCredentialsMessage)+" ")])]):t._e(),a("button",{staticClass:"btn yellow-color",attrs:{type:"submit"},on:{click:function(e){return t.doLogin()}}},[t._v(" Log in ")]),a("p",[t._v(" Don't have an account? "),a("a",{attrs:{href:"#"},on:{click:function(e){t.registerActive=!t.registerActive,t.emptyFields=!1}}},[t._v("Sign up here")])])])])])])])])])},J=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"illustration"},[i("h1",[t._v("What A Trip")]),i("img",{staticClass:"img-fluid",attrs:{src:a(9144),alt:"What a trip logo"}})])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"illustration"},[i("h1",[t._v("What A Trip")]),i("img",{staticClass:"img-fluid",attrs:{src:a(9144),alt:"What a trip logo"}})])}],I={name:"LoginPage",components:{},data(){return{registerActive:!1,usernameLogin:null,passwordLogin:null,email:null,usernameRegistration:null,passwordRegistration:null,confirmPassword:null,emptyFields:!1,authenticationResponse:null,showWrongCredentials:!1,wrongCredentialsMessage:null,credentialsExistingMessage:null,showCredentialsExisting:!1,showErrorMessage:!1,errorMessage:null,usernameLoginError:!1,passwordLoginError:!1,usernameRegistrationError:!1,emailError:!1,passwordRegistrationError:!1,confirmPasswordError:!1,errors:[],errorsLogin:[],validation:{invalid:{},valid:{}}}},methods:{async doLogin(){if(this.clearValidationRegistration(),this.validateLogin()){this.showWrongCredentials=!1;let t,e={username:this.usernameLogin,password:this.passwordLogin};if(await p.authenticateUser(e).then((t=>{this.authenticationResponse=t})).catch((function(e){console.log(e),t=e.response.status})),401==t||404==t)this.wrongCredentials();else if(200==this.authenticationResponse.status){this.showWrongCredentials=!1,this.validation.invalid.credentials="",this.validation.valid.credentials="The credentials seems to be ok, you will be redirected to your personal workspace in a few seconds.",console.log(this.authenticationResponse);let t=this.authenticationResponse.data["x-access-token"];localStorage.setItem("token",t),localStorage.setItem("id",this.authenticationResponse.data.ID),localStorage.setItem("username",this.authenticationResponse.data.USERNAME),localStorage.setItem("email",this.authenticationResponse.data.EMAIL),localStorage.setItem("role",this.authenticationResponse.data.ROLE),localStorage.setItem("isLogged",!0),this.$router.push({path:"/welcome"})}else console.log("There is a problem")}else this.emptyFields=!0},clearValidationLogin(){this.validation.valid.usernameLogin="",this.validation.invalid.usernameLogin="",this.validation.valid.passwordLogin="",this.validation.invalid.passwordLogin=""},clearValidationRegistration(){this.validation.valid.usernameRegistration="",this.validation.invalid.usernameRegistration="",this.validation.valid.passwordRegistration="",this.validation.invalid.passwordRegistration="",this.validation.valid.confirmPassword="",this.validation.invalid.confirmPassword="",this.validation.valid.email="",this.validation.invalid.email=""},async doRegister(){let t;if(this.clearValidationLogin(),this.validateRegistration()){let e={email:this.email,username:this.usernameRegistration,password:this.passwordRegistration};if(await p.createUser(e).then((t=>{this.authenticationResponse=t})).catch((function(e){t=e.response.status,console.log(e)})),401==t||404==t||500==t||409==t)this.credentialsExisting(t);else if(200==this.authenticationResponse.status){console.log(this.authenticationResponse);let t=this.authenticationResponse.data["x-access-token"];localStorage.setItem("token",t),localStorage.setItem("id",this.authenticationResponse.data.ID),localStorage.setItem("username",this.authenticationResponse.data.USERNAME),localStorage.setItem("email",this.authenticationResponse.data.EMAIL),localStorage.setItem("isLogged",!0),localStorage.setItem("role",this.authenticationResponse.data.ROLE),this.$router.push({path:"/welcome"})}else alert("Sorry! there is an error")}else this.emptyFields=!0},validateLogin:function(){return this.usernameLogin?this.usernameLogin.length<5?(this.usernameLoginError=!0,this.validation.invalid.usernameLogin="Are you sure you typed the correct username? Username should have min. 5 characters.",this.validation.valid.usernameLogin=""):(this.usernameLoginError=!1,this.validation.valid.usernameLogin="Username is OK.",this.validation.invalid.usernameLogin=""):this.validation.invalid.usernameLogin="Please type your username.",this.passwordLogin?this.passwordLogin.length<8?(this.passwordLoginError=!0,this.validation.invalid.passwordLogin="This is not the right password. Password should have min. 8 characters.",this.validation.valid.passwordLogin=""):(this.passwordLoginError=!1,this.validation.valid.passwordLogin="Password is fine.",this.validation.invalid.passwordLogin=""):(this.passwordLoginError=!0,this.validation.invalid.passwordLogin="Please type your password."),this.$forceUpdate(),!this.usernameLoginError&&!this.passwordLoginError},validateRegistration:function(){return this.email?this.email.length<10||-1==this.email.search("@")||-1==this.email.search(".")?(this.emailError=!0,this.validation.invalid.email="Please provide a valid email address.",this.validation.valid.email=""):(this.emailError=!1,this.validation.valid.email="Email is OK.",this.validation.invalid.email=""):this.validation.invalid.email="Please type your email.",this.usernameRegistration?this.usernameRegistration.length<5?(this.usernameRegistrationError=!0,this.validation.invalid.usernameRegistration="Are you sure you types the correct username? Username should have min. 5 characters.",this.validation.valid.usernameRegistration=""):(this.usernameRegistrationError=!1,this.validation.valid.usernameRegistration="Username is OK.",this.validation.invalid.usernameRegistration=""):this.validation.invalid.usernameRegistration="Please type your username.",this.passwordRegistration?this.passwordRegistration.length<8?(this.passwordRegistrationError=!0,this.validation.invalid.passwordRegistration="This is the right password. Password should have min. 8 characters.",this.validation.valid.passwordRegistration=""):(this.passwordRegistrationError=!1,this.validation.valid.passwordRegistration="Password is fine.",this.validation.invalid.passwordRegistration=""):(this.passwordRegistrationError=!0,this.validation.invalid.passwordRegistration="Please type your password."),this.confirmPassword?this.confirmPassword!=this.passwordRegistration||this.confirmPassword.length<8?(this.confirmPasswordError=!0,this.validation.invalid.confirmPassword="The passwords are different. Please  type again",this.validation.valid.confirmPassword=""):(this.confirmPasswordError=!1,this.validation.valid.confirmPassword="Password is fine.",this.validation.invalid.confirmPassword=""):(this.confirmPasswordError=!0,this.validation.invalid.confirmPassword="Please type your password."),this.$forceUpdate(),!(this.emailError||this.usernameRegistrationError||this.passwordRegistrationError||this.confirmPasswordError)},wrongCredentials:function(){this.showWrongCredentials=!0,this.wrongCredentialsMessage="The username and/or password you entered are incorrect.",this.validation.valid.usernameLogin="",this.validation.valid.passwordLogin="",this.validation.invalid.usernameLogin="Check if you typed the correct username",this.validation.invalid.passwordLogin="Check if you typed the correct password"},credentialsExisting:function(t){404==t||401==t?(this.showCredentialsExisting=!1,this.showErrorMessage=!0,this.validation.valid.usernameRegistration="",this.validation.invalid.usernameRegistration=" ",this.validation.valid.passwordRegistration="",this.validation.invalid.passwordRegistration=" ",this.validation.valid.email="",this.validation.invalid.email=" ",this.validation.valid.confirmPassword="",this.validation.invalid.confirmPassword=" ",this.errorMessage="Sorry! An error occured. Try another email"):(this.errorMessage="",this.showCredentialsExisting=!0,409==t?(this.validation.valid.usernameRegistration="",this.validation.invalid.usernameRegistration="This username is already used",this.credentialsExistingMessage="The username you entered is already used."):(this.validation.valid.email="",this.validation.invalid.email="This email is already used",this.credentialsExistingMessage="The email you entered is already registered."))}}},M=I,G=(0,m.Z)(M,N,J,!1,null,"116effa2",null),U=G.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"container my-margin"},[a("h1",{staticClass:"titles"},[t._v("My trips")]),a("div",{staticClass:"row justify-content-between"},[a("div",{staticClass:"col-sm-4"},[a("h4",[t._v("Filter trips by date")]),a("date-picker",{staticClass:"width",attrs:{"value-type":"format",format:"YYYY-MM-DD",type:"date",range:"",placeholder:"Select date range"},on:{change:function(e){return t.filterByDates()}},model:{value:t.selectedDate,callback:function(e){t.selectedDate=e},expression:"selectedDate"}})],1),a("div",{staticClass:"col-sm-4"},[a("router-link",{staticStyle:{color:"white","text-decoration":"none"},attrs:{to:"update-trip"}},[a("button",{staticClass:"btn orange-color w-100",staticStyle:{float:"right"}},[t._v(" Add trip ")])])],1),a("div",{staticClass:"row"})]),a("div",{staticClass:"row"},[a("div",{staticClass:"col map"},[t.dataLoaded?a("Map",{key:t.pathJsonKey,attrs:{tripList:t.tripList}}):t._e()],1)]),a("div",[a("table",{class:t.windowWidth>760?"table":"",attrs:{role:"table"}},[a("thead",{attrs:{role:"rowgroup"}},[a("tr",{attrs:{role:"row"}},[a("th",{attrs:{role:"columnheader"}}),a("th",{staticStyle:{cursor:"pointer"},attrs:{role:"columnheader"},on:{click:function(e){return t.sort("DATE")}}},[t._v(" Date"),a("b-icon",{staticStyle:{"margin-left":"5px"},attrs:{icon:"sort-alpha-up-alt"}})],1),a("th",{staticStyle:{cursor:"pointer"},attrs:{role:"columnheader"},on:{click:function(e){return t.sort("PLACE")}}},[t._v(" Place"),a("b-icon",{staticStyle:{"margin-left":"5px"},attrs:{icon:"sort-alpha-up-alt"}})],1),a("th",{staticStyle:{cursor:"pointer"},attrs:{role:"columnheader"},on:{click:function(e){return t.sort("TRANSPORTATION")}}},[t._v(" Transportation"),a("b-icon",{staticStyle:{"margin-left":"5px"},attrs:{icon:"sort-alpha-up-alt"}})],1),a("th",{attrs:{role:"columnheader"}},[t._v("Main Stages")])])]),a("tbody",{attrs:{role:"rowgroup"}},t._l(t.sortedTrips,(function(e){return a("tr",{key:e.ID,staticClass:"colored",attrs:{role:"row"}},[a("td",{attrs:{role:"cell"}},[a("router-link",{staticStyle:{color:"#ff6f3c"},attrs:{to:"update-trip?idTrip="+e.ID}},[a("b-icon",{attrs:{icon:"pencil"}})],1)],1),a("td",{attrs:{role:"cell"}},[t._v(t._s(e.DATE))]),a("td",{attrs:{role:"cell"}},[t._v(t._s(e.PLACE))]),a("td",{attrs:{role:"cell"}},[t._v(t._s(e.TRANSPORTATION))]),a("td",{attrs:{role:"cell"}},t._l(e.GEOJSON.features,(function(e,i){return a("span",{key:i},["Point"===e.geometry.type?a("span",[t._v(" "+t._s(e.properties.name)+" ")]):t._e()])})),0)])})),0)])])]),a("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var i=e.close;return[a("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return i()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var i=e.ok;return[a("span",{staticStyle:{"padding-right":"40px"}},[a("b-button",{staticClass:"orange-color",on:{click:function(t){return i()}}},[t._v("OK")])],1)]}}]),model:{value:t.showExpiredError,callback:function(e){t.showExpiredError=e},expression:"showExpiredError"}},[[a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Your session is expired. ")]),a("p",{staticStyle:{"text-align":"center"}},[t._v(" You will be redirected to the home page in a few seconds. ")]),a("div",{staticClass:"row justify-content-center"},[t.showLoader?a("div",{staticClass:"loader"},[a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("span",[t._v("Redirecting...")])]):t._e()])]],2)],1)},j=[],z=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"constainer justify-content-center"},[a("l-map",{ref:"map",staticStyle:{height:"470px",width:"100%"},attrs:{zoom:t.zoom,center:t.center}},[a("l-tile-layer",{attrs:{url:t.url,attribution:t.attribution}})],1)],1)])},F=[],W=a(5243),Y=a(5352),Z=a(2727),K={props:{tripList:Object},name:"map-component",components:{LMap:Y.Z,LTileLayer:Z.Z},data(){return{map:null,url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a> contributors',zoom:6,markerLatLng:[45.859412,13.601074],center:[45.65052568917208,13.76517096104127],allMarkers:[],allPolylines:[],bounds:(0,W.latLngBounds)({lat:51.476483373501964,lng:-.14668464136775586},{lat:51.52948330894063,lng:-.019140238291583955}),j:null}},methods:{loadMap(){this.map=this.$refs.map.mapObject;let t=(new W.FeatureGroup).addTo(this.map),e=this;function a(a,i){t.addLayer(i),void 0==a.properties.description||null==a.properties.description?i.bindPopup("<p>"+a.properties.name+" ("+a.geometry.coordinates[1]+", "+a.geometry.coordinates[0]+")</p><hr/><p style='font-size:14px'>You were here on "+e.tripList[e.j].DATE+", and the trasportation type is: "+e.tripList[e.j].TRANSPORTATION+"</p>"):i.bindPopup("<p>"+a.properties.name+" ("+a.geometry.coordinates[1]+", "+a.geometry.coordinates[0]+")</p><hr/><p style='font-size:14px'>"+a.properties.description+"</p>")}if(this.tripList.length>0){for(let t=0;t<this.tripList.length;++t)this.j=t,W.geoJson(this.tripList[t].GEOJSON,{onEachFeature:a,color:"red"}).addTo(this.map);this.map.fitBounds(t.getBounds()),this.zoom=6}}},mounted(){this.loadMap()}},B=K,X=(0,m.Z)(B,z,F,!1,null,null,null),q=X.exports;const H="/WhatATrip/api/";var V={async getAllTrips(t,e){return d().get(H+t+"/trips/",{headers:{"x-access-token":e}})},async getTrip(t,e,a){return d().get(H+t+"/trips/"+e,{headers:{"x-access-token":a}})},async createTrip(t,e,a){return d().post(H+t+"/trips/",JSON.stringify(a),{headers:{"Content-type":"application/json","x-access-token":e}})},async updateTrip(t,e,a,i){return d().put(H+t+"/trips/"+e,JSON.stringify(i),{headers:{"Content-type":"application/json","x-access-token":a}})},async deleteTrip(t,e,a){return d()["delete"](H+t+"/trips/"+e,{headers:{"x-access-token":a}})}},Q=a(796),tt={name:"Dashboard-component",components:{Map:q,DatePicker:Q.Z},data(){return{selectedDate:[new Date,new Date((new Date).getTime()+7776e5)],idUser:null,username:null,tripList:null,pathJson:[],dataLoaded:!1,pathJsonKey:1,showExpiredError:!1,showLoader:!0,currentSort:"DATE",currentSortDir:"desc",windowWidth:window.screen.width}},mounted:async function(){this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token"),await this.getTrips(),this.$nextTick((()=>{window.addEventListener("resize",this.onResize)}))},methods:{filterByDates:async function(){let t=this.selectedDate[0],e=this.selectedDate[1];if(null==t&&null==e)await this.getTrips();else{await this.getTrips();let a=this.tripList.filter((function(e){return e.DATE>=t})),i=a.filter((function(t){return t.DATE<=e}));this.dataLoaded=!1,this.tripList=i,this.dataLoaded=!0,this.$forceUpdate(),this.pathJsonKey+=1}},getTrips:async function(){let t,e=0;if(await V.getAllTrips(this.idUser,this.token).then((e=>{this.tripList=e.data,t=e.status})).catch((function(t){e=t.response.status,console.log(t)})),0!=e)this.showExpiredError=!0,setTimeout((()=>{p.logout(),this.redirectLogout()}),2e3);else if(200===t&&null!=this.tripList)for(let a=0;a<this.tripList.length;++a)null!=this.tripList[a].GEOJSON&&(this.tripList[a].GEOJSON=JSON.parse(this.tripList[a].GEOJSON));this.pathJsonKey+=1,this.dataLoaded=!0},onResize(){this.windowWidth=window.screen.width},redirectLogout:function(){this.$router.push({path:"/login"})},sort:function(t){t===this.currentSort&&(this.currentSortDir="asc"===this.currentSortDir?"desc":"asc"),this.currentSort=t}},computed:{sortedTrips:function(){if(void 0!=this.tripList&&null!=this.tripList){let t=this.tripList;return t.sort(((t,e)=>{let a=1;return"desc"===this.currentSortDir&&(a=-1),t[this.currentSort]<e[this.currentSort]?-1*a:t[this.currentSort]>e[this.currentSort]?1*a:0}))}return 0}}},et=tt,at=(0,m.Z)(et,$,j,!1,null,"5f5369ff",null),it=at.exports,st=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"container my-margin"},[a("section",[a("h1",{staticClass:"titles"},[t._v("Admin dashboard")]),a("h3",[t._v("List of users")]),a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-responsive-sm table-responsive-md"},[t._m(0),a("tbody",t._l(t.userList,(function(e){return a("tr",{key:e.ID,staticClass:"colored"},[a("td",[t._v(" "+t._s(e.USERNAME)+" ")]),a("td",[t._v(t._s(e.EMAIL))])])})),0)])]),a("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var i=e.close;return[a("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return i()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var i=e.ok;return[a("span",{staticStyle:{"padding-right":"40px"}},[a("b-button",{staticClass:"orange-color",on:{click:function(t){return i()}}},[t._v("OK")])],1)]}}]),model:{value:t.showExpiredError,callback:function(e){t.showExpiredError=e},expression:"showExpiredError"}},[[a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Your session is expired. ")]),a("p",{staticStyle:{"text-align":"center"}},[t._v(" You will be redirected to the home page in a few seconds. ")]),a("div",{staticClass:"row justify-content-center"},[t.showLoader?a("div",{staticClass:"loader"},[a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("span",[t._v("Redirecting...")])]):t._e()])]],2)],1)])])},ot=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Username")]),a("th",[t._v("Email")])])])}],rt={name:"Dashboard-component",components:{},data(){return{idUser:null,username:null,userList:null,showExpiredError:!1,showLoader:!0}},mounted:async function(){this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token"),await this.getUsers()},methods:{getUsers:async function(){let t,e=0;await p.getAllUsers(this.token).then((e=>{console.log(e),this.userList=e.data,t=e.status})).catch((function(t){e=t.response.status,console.log(t)})),0!=e?(this.showExpiredError=!0,setTimeout((()=>{p.logout(),this.redirectLogout()}),2e3)):200===t&&console.log(this.userList),this.pathJsonKey+=1,this.dataLoaded=!0},redirectLogout:function(){this.$router.push({path:"/login"})}}},nt=rt,lt=(0,m.Z)(nt,st,ot,!1,null,"0e81d627",null),dt=lt.exports,ct=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container my-margin",attrs:{id:"app"}},[a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col"},[null!=t.idTrip?a("h2",{staticClass:"titles"},[t._v(" Update your trip of "+t._s(t.date)+" ")]):a("h2",{staticClass:"titles"},[t._v("Add a new trip")]),a("p",[t._v("First draw your route and then add your stages")])])]),t.dataLoaded?a("div",{staticClass:"row justify-content-center"},[a("DrawableMap",{key:t.stageNameKey,ref:"map",attrs:{myTripGeoJSON:t.myTripGeoJSON,maxDistanceError:t.maxDistanceError},on:{updateCoordinates:t.updateTripCoordinates}})],1):t._e(),a("hr"),a("form",{on:{submit:function(t){t.preventDefault()}}},[a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"date"}},[t._v("Date")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.date,expression:"date"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.date,"is-invalid":t.validation.invalid.date},attrs:{type:"date",id:"date"},domProps:{value:t.date},on:{input:function(e){e.target.composing||(t.date=e.target.value)}}}),t.validation.valid.date?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.date)+" ")]):t._e(),t.validation.invalid.date?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.date)+" ")]):t._e()]),a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"place"}},[t._v("Place")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.place,expression:"place"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.place,"is-invalid":t.validation.invalid.place},attrs:{type:"text",id:"place"},domProps:{value:t.place},on:{input:function(e){e.target.composing||(t.place=e.target.value)}}}),t.validation.valid.place?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.place)+" ")]):t._e(),t.validation.invalid.place?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.place)+" ")]):t._e()]),a("div",{staticClass:"mb-3"},[a("label",{staticClass:"form-label",attrs:{for:"transportation"}},[t._v("Transportation")]),a("select",{directives:[{name:"model",rawName:"v-model",value:t.transportation,expression:"transportation"}],staticClass:"form-select",class:{"is-valid":t.validation.valid.transportation,"is-invalid":t.validation.invalid.transportation},attrs:{id:"transportation"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.transportation=e.target.multiple?a:a[0]}}},[t._m(0)]),t.validation.valid.transportation?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.transportation)+" ")]):t._e(),t.validation.invalid.transportation?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.transportation)+" ")]):t._e()]),null!=t.myTripGeoJSON&&t.myTripGeoJSON.features.length>1?a("div",[a("h5",[t._v("Main stages")]),t._l(t.myTripGeoJSON.features,(function(e,i){return a("div",{key:i,staticClass:"mb-3"},["Point"==e.geometry.type?a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm"},[a("label",{staticClass:"form-label",attrs:{for:"stage_name"}},[t._v("Stage name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.properties.name,expression:"value.properties.name"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.properties.name},on:{change:function(e){return t.updateStage()},input:function(a){a.target.composing||t.$set(e.properties,"name",a.target.value)}}})]),a("div",{staticClass:"col-sm"},[a("label",{staticClass:"form-label",attrs:{for:"latitude"}},[t._v("Latitude")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.geometry.coordinates[1],expression:"value.geometry.coordinates[1]"}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:e.geometry.coordinates[1]},on:{input:function(a){a.target.composing||t.$set(e.geometry.coordinates,1,a.target.value)}}})]),a("div",{staticClass:"col-sm"},[a("label",{staticClass:"form-label",attrs:{for:"longitude"}},[t._v("Longitude")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.geometry.coordinates[0],expression:"value.geometry.coordinates[0]"}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:e.geometry.coordinates[0]},on:{input:function(a){a.target.composing||t.$set(e.geometry.coordinates,0,a.target.value)}}})]),a("div",{staticClass:"col-sm"},[a("label",{staticClass:"form-label",attrs:{for:"descriptionProp"}},[t._v("Description")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.properties.description,expression:"value.properties.description"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:e.properties.description},on:{change:function(e){return t.updateStage()},input:function(a){a.target.composing||t.$set(e.properties,"description",a.target.value)}}})]),a("hr")]):t._e()])}))],2):t._e(),a("div",{staticClass:"mb-3"},[a("div",{staticClass:"custom-control custom-checkbox checkbox-lg"},[a("label",{staticClass:"form-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.showAddDescription,expression:"showAddDescription"}],staticClass:"custom-control-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.showAddDescription)?t._i(t.showAddDescription,null)>-1:t.showAddDescription},on:{change:function(e){var a=t.showAddDescription,i=e.target,s=!!i.checked;if(Array.isArray(a)){var o=null,r=t._i(a,o);i.checked?r<0&&(t.showAddDescription=a.concat([o])):r>-1&&(t.showAddDescription=a.slice(0,r).concat(a.slice(r+1)))}else t.showAddDescription=s}}}),t._v(" Do you want to add a short description of the trip?")])]),t.showAddDescription?a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],staticClass:"form-control",class:{"is-valid":t.validation.valid.description,"is-invalid":t.validation.invalid.description},attrs:{rows:"5"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}):t._e(),t.validation.valid.description?a("div",{staticClass:"valid-feedback"},[t._v(" "+t._s(t.validation.valid.description)+" ")]):t._e(),t.validation.invalid.description?a("div",{staticClass:"invalid-feedback"},[t._v(" "+t._s(t.validation.invalid.description)+" ")]):t._e()])]),t.maxDistanceError?a("div",[a("p",{staticClass:"error-marker"},[t._v(" You can't save a trip with a marker too far from the route. ")])]):t._e(),t.routeError?a("div",[a("p",{staticClass:"error-marker"},[t._v("You can't save a trip without a route.")])]):t._e(),a("div",{staticClass:"row margin-button"},[null!=t.idTrip?a("div",{staticClass:"col"},[a("button",{staticClass:"btn yellow-color w-100",attrs:{type:"button"},on:{click:function(e){return t.confirmDeleteTrip()}}},[t._v(" Delete trip ")])]):t._e(),a("div",{staticClass:"col"},[a("button",{staticClass:"btn yellow-color w-100",attrs:{type:"button"},on:{click:function(e){return t.saveTrip()}}},[t._v(" Save ")])])]),a("div",{staticClass:"row margin-button"},[a("div",{staticClass:"col"},[a("router-link",{staticClass:"btn orange-color w-100",staticStyle:{color:"white"},attrs:{to:"/dashboard"}},[t._v("Go back")])],1)]),a("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var i=e.close;return[a("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return i()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var i=e.cancel;return[t.showLoader?t._e():a("span",{staticStyle:{"padding-left":"40px"}},[a("b-button",{staticClass:"yellow-color",on:{click:function(t){return i()}}},[t._v("NO")])],1),t.showLoader?t._e():a("span",{staticStyle:{"padding-right":"40px"}},[a("b-button",{staticClass:"orange-color",on:{click:function(e){return t.deleteTrip()}}},[t._v("YES")])],1),t.showLoader?a("span",{staticStyle:{"padding-left":"40px"}}):t._e()]}}]),model:{value:t.showDeleteTrip,callback:function(e){t.showDeleteTrip=e},expression:"showDeleteTrip"}},[[a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Are you sure you want to delete the trip? ")]),t.showLoader?a("div",{staticClass:"row justify-content-center"},[a("p",{staticStyle:{"text-align":"center"}},[t._v(" You will be redirected to the home page in a few seconds. ")]),a("div",{staticClass:"loader",staticStyle:{"margin-bottom":"10px"}},[a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("span",[t._v("Deleting trip...")])])]):t._e()]],2),a("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var i=e.close;return[a("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return i()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var i=e.ok;return[a("span",{staticStyle:{"padding-right":"40px"}},[a("b-button",{staticClass:"orange-color",on:{click:function(t){return i()}}},[t._v("OK")])],1)]}}]),model:{value:t.showSuccessTrip,callback:function(e){t.showSuccessTrip=e},expression:"showSuccessTrip"}},[[null!=t.idTrip?a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Your trip was successfully updated. ")]):a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Your trip was successfully created. ")]),a("p",{staticStyle:{"text-align":"center"}},[t._v(" You will be redirected to the home page in a few seconds. ")]),a("div",{staticClass:"row justify-content-center"},[t.showLoader?a("div",{staticClass:"loader"},[a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("span",[t._v("Redirecting...")])]):t._e()])]],2),a("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var i=e.close;return[a("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return i()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var i=e.ok;return[a("span",{staticStyle:{"padding-right":"40px"}},[a("b-button",{staticClass:"orange-color",on:{click:function(t){return i()}}},[t._v("OK")])],1)]}}]),model:{value:t.showExpiredError,callback:function(e){t.showExpiredError=e},expression:"showExpiredError"}},[[a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Your session is expired. ")]),a("p",{staticStyle:{"text-align":"center"}},[t._v(" You will be redirected to the home page in a few seconds. ")]),a("div",{staticClass:"row justify-content-center"},[t.showLoader?a("div",{staticClass:"loader"},[a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("span",[t._v("Redirecting...")])]):t._e()])]],2)],1)},pt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("optgroup",{attrs:{label:"Choose transportation"}},[a("option",{attrs:{value:"Bike"}},[t._v("Bike")]),a("option",{attrs:{value:"Bus"}},[t._v("Bus")]),a("option",{attrs:{value:"Boat"}},[t._v("Boat")]),a("option",{attrs:{value:"Car"}},[t._v("Car")]),a("option",{attrs:{value:"Motorcycle"}},[t._v("Motorcycle")]),a("option",{attrs:{value:"On foot"}},[t._v("On foot")]),a("option",{attrs:{value:"Plane"}},[t._v("Plane")]),a("option",{attrs:{value:"Train"}},[t._v("Train")]),a("option",{attrs:{value:"Other"}},[t._v("Other")])])}],ut=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"row justify-content-center",attrs:{id:"map"}},[a("l-map",{ref:"map",staticStyle:{height:"450px",width:"100%"},attrs:{zoom:t.zoom,center:t.center},on:{"update:zoom":t.zoomUpdated,"update:center":t.centerUpdated,"update:bounds":t.boundsUpdated}},[a("l-tile-layer",{ref:"layer",attrs:{url:t.url}})],1)],1),t.distanceError?a("div",[a("p",{staticClass:"error-marker"},[t._v(" The maximum distance allowed between the stage and the route is 200 m. Your stage is "+t._s(t.distance)+"m from the route. ")])]):t._e(),t.editRouteAlert?a("div",[a("p",{staticClass:"alert-message"},[t._v(" If you edit or remove your route you will lose all your stages. ")])]):t._e(),null!=t.geoJsonText?a("div",{staticClass:"mb-3"},[a("div",{staticClass:"custom-control custom-checkbox checkbox-lg"},[a("label",{staticClass:"form-label"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.showGeoJson,expression:"showGeoJson"}],staticClass:"custom-control-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.showGeoJson)?t._i(t.showGeoJson,null)>-1:t.showGeoJson},on:{change:function(e){var a=t.showGeoJson,i=e.target,s=!!i.checked;if(Array.isArray(a)){var o=null,r=t._i(a,o);i.checked?r<0&&(t.showGeoJson=a.concat([o])):r>-1&&(t.showGeoJson=a.slice(0,r).concat(a.slice(r+1)))}else t.showGeoJson=s}}}),t._v(" Do you want to see the geoJson of your trip?")])]),t.showGeoJson?a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.geoJsonText,expression:"geoJsonText"}],staticClass:"form-control",attrs:{rows:"15",readonly:""},domProps:{value:t.geoJsonText},on:{input:function(e){e.target.composing||(t.geoJsonText=e.target.value)}}}):t._e()]):t._e()])},ht=[],mt=(a(4607),a(1335)),vt=(a(3693),{props:{myTripGeoJSON:Object,maxDistanceError:Boolean},components:{},data(){return{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",map:null,drawnItems:null,zoom:8,center:[45.859412,13.601074],bounds:null,tileLayer:null,geoJsonText:null,distanceError:!1,distance:null,editRouteAlert:!1,showGeoJson:!1}},mounted(){this.drawnItems=this.initMap(),this.$emit("updateCoordinates",this.drawnItems.toGeoJSON(),this.maxDistanceError)},methods:{zoomUpdated(t){this.zoom=t},centerUpdated(t){this.center=t},boundsUpdated(t){this.bounds=t},initMap(){this.map=this.$refs.map.mapObject;let t=(new W.FeatureGroup).addTo(this.map);this.map.addLayer(t);let e=this;function a(e,a){t.addLayer(a),a.bindPopup("<p>"+e.properties.name+" ("+e.geometry.coordinates[1]+", "+e.geometry.coordinates[0]+")</p><p v-if='feature.properties.description'>"+e.properties.description+"</p>")}if(this.map.pm.addControls({position:"topleft",drawMarker:!1,drawPolyline:{snappable:!0,snapDistance:20},drawRectangle:!1,drawPolygon:!1,drawCircleMarker:!1,drawCircle:!1,drawText:!1,rotateMode:!1,dragMode:!1,cutPolygon:!1}),null==this.myTripGeoJSON||"undefined"===this.myTripGeoJSON);else if(0!=Object.entries(this.myTripGeoJSON).length){let e=W.geoJson(this.myTripGeoJSON,{onEachFeature:a,color:"red"}).addTo(this.map),i=this.myTripGeoJSON.features.filter((t=>"LineString"===t.geometry.type));s(e.getLayers()),null!=i&&i.length>0&&(this.map.pm.addControls({drawPolyline:!1}),this.map.pm.addControls({drawMarker:!0}));for(let a=0;a<this.myTripGeoJSON.features.length;++a)if("Point"===this.myTripGeoJSON.features[a].geometry.type){let s=mt.xmu([this.myTripGeoJSON.features[a].geometry.coordinates[0],this.myTripGeoJSON.features[a].geometry.coordinates[1]]),o=mt.TuJ(i[0].geometry.coordinates),r=mt.OyL(s,o,{units:"meters"});r>200?(this.distance=r.toFixed(2),this.distanceError=!0,this.$emit("updateCoordinates",t.toGeoJSON(),this.distanceError)):this.distanceError=!1,this.map.fitBounds(e.getBounds());break}}let i=this.getPath(t);function s(){let a=JSON.stringify(t.toGeoJSON(),null,4);e.geoJsonText=a.toString()}return this.map.on("pm:create",(function(a){let s=a.layer,o=s.feature=s.feature||{};if(o.type="Feature",o.properties=o.properties||{},o.properties["name"]="Stage",o.properties["description"]=null,i=e.getPath(t),"Line"===s.pm._shape)o.properties["name"]="Path",t.addLayer(s),e.map.pm.addControls({drawPolyline:!1}),e.map.pm.addControls({drawMarker:!0}),e.$emit("updateCoordinates",t.toGeoJSON(),e.maxDistanceError);else{let a=mt.xmu([s._latlng.lng,s._latlng.lat]),o=mt.TuJ(i),r=mt.OyL(a,o,{units:"meters"});r<=200?(e.distanceError=!1,t.addLayer(s),e.$emit("updateCoordinates",t.toGeoJSON(),e.distanceError),e.distance=r.toFixed(2)):(e.distance=r.toFixed(2),e.distanceError=!0,e.map.removeLayer(s))}})),t.on("pm:enable",(()=>{this.editRouteAlert=!0})),t.on("pm:disable",(()=>{this.editRouteAlert=!1,this.distanceError=!1})),t.on("pm:edit",(function(a){let s=a.layer;if(e.editRouteAlert=!1,"Line"===s.pm._shape)e.map.eachLayer((function(e){e instanceof W.Marker&&t.removeLayer(e)}));else{let a=mt.xmu([s._latlng.lng,s._latlng.lat]),o=mt.TuJ(i),r=mt.OyL(a,o,{units:"meters"});r<=200?(e.distanceError=!1,t.addLayer(s),e.$emit("updateCoordinates",t.toGeoJSON(),e.distanceError),e.distance=r.toFixed(2),e.map.pm.addControls({drawMarker:!0})):(e.distance=r.toFixed(2),e.distanceError=!0,e.map.pm.addControls({drawMarker:!1}))}e.$emit("updateCoordinates",t.toGeoJSON(),e.distanceError)})),this.map.on("pm:globalremovalmodetoggled",(()=>{e.editRouteAlert=!0})),this.map.on("pm:remove",(a=>{e.editRouteAlert=!1;let i=a.layer;"Line"===i.pm._shape&&(e.map.pm.addControls({drawPolyline:!0}),e.map.pm.addControls({drawMarker:!1}),e.distanceError=!1,t.eachLayer((function(e){e instanceof W.Marker&&t.removeLayer(e)}))),t.removeLayer(a.layer),e.$emit("updateCoordinates",t.toGeoJSON(),e.distanceError),s(a)})),this.map.addEventListener("pm:create",s),t.addEventListener("pm:edit",s),t},updateCoordinates(){this.$emit("updateCoordinates",this.drawnItems.toGeoJSON(),this.distanceError)},getPath(t){let e=t.toGeoJSON().features;if(e.length>0){let t=e.filter((t=>"LineString"===t.geometry.type));return t[0].geometry.coordinates}return null}}}),gt=vt,ft=(0,m.Z)(gt,ut,ht,!1,null,"4b5d311f",null),wt=ft.exports,yt={name:"ModificaViaggio",components:{DrawableMap:wt},data(){return{date:null,place:null,transportation:null,description:null,showAddDescription:!1,path:[],latitude:null,longitude:null,stage:null,mainStages:[],stageNameKey:1,pathCoordinates:[],polylines:[],markers:[],myTripGeoJSON:null,maxDistanceError:!1,idUser:null,username:null,token:null,idTrip:null,dataLoaded:!1,validation:{invalid:{},valid:{}},showSuccessTrip:!1,errorDate:!1,errorPlace:!1,errorTransportation:!1,errorDescription:!1,routeError:!1,errorStatus:!1,showErrorMessage:!1,showExpiredError:!1,showDeleteTrip:!1,showLoader:!1}},beforeMount:async function(){this.idTrip=this.$route.query.idTrip,this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token"),null!=this.$route.query.idTrip?await this.loadTrip():this.dataLoaded=!0},mounted:function(){},methods:{checkInformations:function(){return this.date?(this.errorDate=!1,this.validation.valid.date="Date is fine",this.validation.invalid.date=""):(this.validation.invalid.date="Please select a date.",this.validation.valid.date="",this.errorDate=!0),this.place?(this.errorPlace=!1,this.validation.valid.place="Place is fine",this.validation.invalid.place=""):(this.validation.invalid.place="Please type a place.",this.validation.valid.place="",this.errorPlace=!0),this.transportation?(this.errorTransportation=!1,this.validation.valid.transportation="Transportation is fine",this.validation.invalid.transportation=""):(this.validation.invalid.transportation="Please select a transportation.",this.validation.valid.transportation="",this.errorTransportation=!0),null!=this.description&&this.description.length>300?(this.validation.invalid.description="You can only inset 200 characters ("+this.description.length+"/200)",this.validation.valid.description="",this.errorDescription=!0):(this.errorDescription=!1,this.validation.valid.description="Description is fine",this.validation.invalid.description=""),this.$forceUpdate(),!(this.errorDate||this.errorPlace||this.errorTransportation||this.errorDescription||this.maxDistanceError||this.checkRoute())},checkRoute:function(){return this.myTripGeoJSON.features.length>0?(this.routeError=!1,!1):(this.routeError=!0,!0)},confirmDeleteTrip:function(){this.showDeleteTrip=!0},deleteTrip:async function(){let t;this.showLoader=!0;let e=0;await V.deleteTrip(this.idUser,this.idTrip,this.token).then((e=>{t=e})).catch((function(t){e=t.response.status,console.log(t)})),0!=e?(this.showExpiredError=!0,setTimeout((()=>{p.logout(),this.redirectLogout()}),2e3)):200==t.status&&setTimeout((()=>{this.redirectToDashboard()}),2e3)},loadTrip:async function(){let t=0;await V.getTrip(this.idUser,this.idTrip,this.token).then((t=>{this.trip=t})).catch((function(e){t=e,console.log(e)})),0!=t?(this.showExpiredError=!0,setTimeout((()=>{p.logout(),this.redirectLogout()}),2e3)):200==this.trip.status&&(this.trip=this.trip.data,this.date=this.trip.DATE,this.place=this.trip.PLACE,this.transportation=this.trip.TRANSPORTATION,this.myTripGeoJSON=JSON.parse(this.trip.GEOJSON),this.description=this.trip.DESCRIPTION,null!=this.description&&(this.showAddDescription=!0),this.getMainStagesAndPathCoordinate(),this.dataLoaded=!0)},saveTrip:async function(){let t,e,a=0;this.checkInformations()&&(null==this.idTrip?(t={PLACE:this.place,TRANSPORTATION:this.transportation,GEOJSON:JSON.stringify(this.myTripGeoJSON),DATE:this.date,USER:this.idUser,DESCRIPTION:this.description},await V.createTrip(this.idUser,this.token,t).then((t=>{e=t})).catch((function(t){a=t.response.status,console.log(t)})),0!=a?(this.showExpiredError=!0,setTimeout((()=>{p.logout(),this.redirectLogout()}),2e3)):200==e.status&&(this.showSuccessTrip=!0,this.showLoader=!0,setTimeout((()=>{this.redirectToDashboard()}),2e3))):(t={ID:this.idTrip,PLACE:this.place,TRANSPORTATION:this.transportation,GEOJSON:JSON.stringify(this.myTripGeoJSON),DATE:this.date,USER:this.idUser,DESCRIPTION:this.description},await V.updateTrip(this.idUser,this.idTrip,this.token,t).then((t=>{e=t})).catch((function(t){a=t.response.status,console.log(t)})),0!=a?(this.showExpiredError=!0,setTimeout((()=>{p.logout(),this.redirectLogout()}),2e3)):200==e.status&&(this.showSuccessTrip=!0,this.showLoader=!0,setTimeout((()=>{this.redirectToDashboard()}),2e3))))},redirectToDashboard:function(){this.$router.push({path:"/dashboard"})},redirectLogout:function(){this.$router.push({path:"/login"})},getMainStagesAndPathCoordinate(){this.mainStages=[],this.pathCoordinates=[];let t=this.myTripGeoJSON.features;for(let e=0;e<this.myTripGeoJSON.features.length;++e)if("Point"===t[e].geometry.type)this.mainStages.push(t[e]);else if("LineString"===t[e].geometry.type){let a=t[e].geometry.coordinates;for(let i=0;i<a.length;++i)this.pathCoordinates.push(t[e])}},updateStage(){this.stageNameKey+=1},updateTripCoordinates(t,e){this.myTripGeoJSON=t,this.maxDistanceError=e,this.getMainStagesAndPathCoordinate()}}},_t=yt,bt=(0,m.Z)(_t,ct,pt,!1,null,"daee2e7e",null),Ct=bt.exports,St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container my-margin",attrs:{id:"app"}},[a("section",[a("div",{staticClass:"row justify-content-center"},[a("h1",{staticClass:"titles"},[t._v(" Welcome, "),a("span",[t._v(t._s(t.username))]),t._v("! ")]),t._m(0)]),a("div",{staticClass:"row justify-content-center",staticStyle:{"padding-top":"5%"}},[a("div",{staticClass:"col-sm"},[a("router-link",{staticClass:"router-link-style",attrs:{to:"dashboard"}},[a("button",{staticClass:"btn orange-color w-100"},[t._v("Your trips")])])],1),a("div",{staticClass:"col-sm"},[a("router-link",{staticClass:"router-link-style",attrs:{to:"update-trip"}},[a("button",{staticClass:"btn orange-color w-100"},[t._v("Add trip")])])],1)]),t._m(1)]),a("b-modal",{attrs:{size:"md"},scopedSlots:t._u([{key:"modal-header",fn:function(e){var i=e.close;return[a("b-button",{staticClass:"dark-color",attrs:{size:"sm"},on:{click:function(t){return i()}}},[t._v("X")])]}},{key:"modal-footer",fn:function(e){var i=e.ok;return[a("span",{staticStyle:{"padding-right":"40px"}},[a("b-button",{staticClass:"orange-color",on:{click:function(t){return i()}}},[t._v("OK")])],1)]}}]),model:{value:t.showExpiredError,callback:function(e){t.showExpiredError=e},expression:"showExpiredError"}},[[a("h3",{staticStyle:{color:"#ff6f3c","text-align":"center","margin-top":"15px"}},[t._v(" Your session is expired. ")]),a("p",{staticStyle:{"text-align":"center"}},[t._v(" You will be redirected to the home page in a few seconds. ")]),a("div",{staticClass:"row justify-content-center"},[t.showLoader?a("div",{staticClass:"loader"},[a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("div",{staticClass:"ball"}),a("span",[t._v("Redirecting...")])]):t._e()])]],2)],1)},Lt=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container-md container-sm"},[i("img",{attrs:{src:a(4813),alt:"What a trip logo"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-content-center"},[a("div",{staticClass:"col-sm"},[a("a",{staticClass:"router-link-style",attrs:{href:"https://youtu.be/kIeKdFZK0GE",target:"_blank"}},[a("button",{staticClass:"btn orange-color w-100"},[t._v("See Tutorial")])])])])}],kt={name:"Welcome-component",components:{},data(){return{idUser:null,username:null,showExpiredError:!1,showLoader:!0}},methods:{redirectLogout:function(){this.$router.push({path:"/login"})}},mounted:async function(){},beforeMount:async function(){this.idUser=localStorage.getItem("id"),this.username=localStorage.getItem("username"),this.token=localStorage.getItem("token")}},Et=kt,xt=(0,m.Z)(Et,St,Lt,!1,null,"7b4867c5",null),Tt=xt.exports,Rt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},Pt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container",attrs:{id:"app"}},[a("div",{staticClass:"my-margin"},[a("h1",{staticClass:"titles"},[t._v("Error!")]),a("h3",{staticClass:"titles"},[t._v("Page not found!")])])])}],Ot={name:"errore-component",components:{},data(){return{}},methods:{}},At=Ot,Dt=(0,m.Z)(At,Rt,Pt,!1,null,"5969e3cd",null),Nt=Dt.exports;i["default"].use(x.Z);const Jt=[{path:"/login",name:"login",component:U,meta:{hideHeader:!0}},{path:"/",name:"Login",component:U,meta:{hideHeader:!0}},{path:"/welcome",name:"Welcome",component:Tt,beforeEnter:(t,e,a)=>{"false"===localStorage.getItem("isLogged")?a({path:"/"}):a()}},{path:"/dashboard",name:"Dashboard",component:it,beforeEnter:(t,e,a)=>{"false"===localStorage.getItem("isLogged")?a({path:"/"}):a()}},{path:"/admin-dashboard",name:"AdminDashboard",component:dt,beforeEnter:(t,e,a)=>{"false"===localStorage.getItem("isLogged")?a({path:"/"}):a()}},{path:"/update-trip",name:"UpdateTrip",component:Ct},{path:"/about",name:"About",component:D,beforeEnter:(t,e,a)=>{"false"===localStorage.getItem("isLogged")?a({path:"/"}):a()}},{path:"/*",name:"Error",component:Nt}],It=new x.Z({mode:"history",base:"/WhatATrip/",routes:Jt});var Mt=It,Gt=(a(7244),a(5069)),Ut=a(3017),$t=a(8380),jt=a(2954),zt=a(4765),Ft=a.n(zt);i["default"].config.productionTip=!1,i["default"].use(Gt.XG7),i["default"].use(Ut.X),i["default"].component("l-map",Y.Z),i["default"].component("l-tile-layer",Z.Z),i["default"].component("l-marker",$t.Z),delete W.Icon.Default.prototype._getIconUrl,W.Icon.Default.mergeOptions({iconRetinaUrl:a(6431),iconUrl:a(7093),shadowUrl:a(8858)}),i["default"].use(jt.ZP,{inject:!0,fieldsBagName:"veeFields",errorBagName:"veeErrors"}),i["default"].use(Ft()),new i["default"]({router:Mt,render:t=>t(E),Base:"/ WhatATrip /",mode:"history"}).$mount("#app")},9620:function(t,e,a){t.exports=a.p+"img/units_logo.c97c643d.jpeg"},9144:function(t,e,a){t.exports=a.p+"img/whatATrip.f1be8bea.png"},4813:function(t,e,a){t.exports=a.p+"img/whatATrip256.a471ac6f.png"},8923:function(t,e,a){t.exports=a.p+"img/whatATripSM64.09780a69.png"}},e={};function a(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,a),o.exports}a.m=t,function(){var t=[];a.O=function(e,i,s,o){if(!i){var r=1/0;for(c=0;c<t.length;c++){i=t[c][0],s=t[c][1],o=t[c][2];for(var n=!0,l=0;l<i.length;l++)(!1&o||r>=o)&&Object.keys(a.O).every((function(t){return a.O[t](i[l])}))?i.splice(l--,1):(n=!1,o<r&&(r=o));if(n){t.splice(c--,1);var d=s();void 0!==d&&(e=d)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[i,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.p="/WhatATrip/"}(),function(){var t={143:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,o,r=i[0],n=i[1],l=i[2],d=0;if(r.some((function(e){return 0!==t[e]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(l)var c=l(a)}for(e&&e(i);d<r.length;d++)o=r[d],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(c)},i=self["webpackChunkWhatATrip"]=self["webpackChunkWhatATrip"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[998],(function(){return a(7282)}));i=a.O(i)})();
//# sourceMappingURL=app.9720cb84.js.map